<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title> - hack</title><meta name="gridsome:hash" content="b2ebea6e6bff6007ac62d293c8b4fab5d2b367c1"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.20"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" name="google-site-verification" content="tMFprx4hdKjMcjVdQJ5-NfuZbUikunZmJJWUI_tvYYM"><meta data-vue-tag="ssr" name="waellet-tip-verification" content="ak_2DDLbYBhHcuAzNg5Un853NRbUr8JVjZeMc6mTUpwmiVzA4ic6X"><meta data-vue-tag="ssr" name="robots" content="index, follow, max-snippet:-1, max-video-preview:-1, max-image-preview:large"><meta data-vue-tag="ssr" property="article:publisher" content="https://facebook.com/hackbg"><meta data-vue-tag="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-tag="ssr" name="twitter:creator" content="@hack_bg"><meta data-vue-tag="ssr" property="og:locale" content="en_US"><meta data-vue-tag="ssr" name="description" content=""><meta data-vue-tag="ssr" property="og:type" content="article"><meta data-vue-tag="ssr" property="og:title" content=""><meta data-vue-tag="ssr" property="og:description" content="00. Why run Bitcoin node? Why Tor? Why Bitcoin full node? A full node allows you to participate in the [&amp;hellip;]"><meta data-vue-tag="ssr" property="og:url" content="https://hack.bg/blog/tutorials/running-full-bitcoin-node-over-tor-on-ubuntu/"><meta data-vue-tag="ssr" property="og:updated_time" content="2021-02-03T10:39:42"><meta data-vue-tag="ssr" property="og:image" content="https://hack.bg/wp-content/uploads/2021/01/bitcoin_tor.png"><meta data-vue-tag="ssr" property="og:image:secure_url" content="https://hack.bg/wp-content/uploads/2021/01/bitcoin_tor.png"><meta data-vue-tag="ssr" property="og:image:width" content="1920"><meta data-vue-tag="ssr" property="og:image:height" content="1080"><meta data-vue-tag="ssr" property="og:image:alt" content=""><meta data-vue-tag="ssr" property="og:image:type" content="image/png"><meta data-vue-tag="ssr" property="article:published_time" content="2021-01-28T15:00:48"><meta data-vue-tag="ssr" property="article:modified_time" content="2021-02-03T10:39:42"><meta data-vue-tag="ssr" property="article:tag" content="Bitcoin"><meta data-vue-tag="ssr" property="article:tag" content="Blockchain"><meta data-vue-tag="ssr" property="article:tag" content="Full node"><meta data-vue-tag="ssr" property="article:tag" content="Node"><meta data-vue-tag="ssr" property="article:tag" content="Tor"><meta data-vue-tag="ssr" property="article:section" content="Tutorials"><meta data-vue-tag="ssr" name="twitter:title" content=""><meta data-vue-tag="ssr" name="twitter:description" content="00. Why run Bitcoin node? Why Tor? Why Bitcoin full node? A full node allows you to participate in the [&amp;hellip;]"><meta data-vue-tag="ssr" name="twitter:image" content="https://hack.bg/wp-content/uploads/2021/01/bitcoin_tor.png"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.9d75eceeef7809cf4608be253410ffaa.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.9d75eceeef7809cf4608be253410ffaa.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.9d75eceeef7809cf4608be253410ffaa.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.9d75eceeef7809cf4608be253410ffaa.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.9d75eceeef7809cf4608be253410ffaa.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.9d75eceeef7809cf4608be253410ffaa.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.9d75eceeef7809cf4608be253410ffaa.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.9d75eceeef7809cf4608be253410ffaa.png"><link data-vue-tag="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400&amp;display=swap"><link data-vue-tag="ssr" rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" integrity="sha384-gfdkjb5BdAXd+lj+gudLWI+BXq4IuLW5IT+brZEZsLFm++aCMlF1V92rMkPaX4PP" crossorigin="anonymous"><link rel="preload" href="/assets/css/0.styles.85ca9fb1.css" as="style"><link rel="preload" href="/assets/js/app.d0c7a0bb.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--word-press-post-vue.744d2abf.js" as="script"><link rel="prefetch" href="/assets/js/page--src--pages--404-vue.a73697d7.js"><link rel="prefetch" href="/assets/js/page--src--pages--about-vue.fcf39de1.js"><link rel="prefetch" href="/assets/js/page--src--pages--blog-vue.6a3cd783.js"><link rel="prefetch" href="/assets/js/page--src--pages--case-studies-vue.15651eb8.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.4a08c2af.js"><link rel="prefetch" href="/assets/js/page--src--templates--word-press-author-vue.c57c0cbb.js"><link rel="prefetch" href="/assets/js/page--src--templates--word-press-category-vue.379d684e.js"><link rel="prefetch" href="/assets/js/page--src--templates--word-press-page-vue.8c461f03.js"><link rel="prefetch" href="/assets/js/page--src--templates--word-press-post-tag-vue.ab1199bc.js"><link rel="prefetch" href="/assets/js/vendors~page--src--pages--blog-vue~page--src--templates--word-press-author-vue~page--src--templates-~6ae1152d.3c03f953.js"><link rel="prefetch" href="/assets/js/vendors~page--src--templates--word-press-category-vue.e7c986f6.js"><link rel="prefetch" href="/assets/js/vendors~page--src--templates--word-press-post-tag-vue.2e2325ff.js"><link rel="prefetch" href="/assets/js/vendors~page--src--templates--word-press-post-vue.03f9d501.js"><link rel="stylesheet" href="/assets/css/0.styles.85ca9fb1.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div id="app" data-server-rendered="true" class="body-bg"><div class="container"><header class="py-2 header" data-v-77ea2ff0><nav id="nav-header" class="navbar p-1 navbar-light navbar-expand-lg" data-v-77ea2ff0><div class="navbar-brand" data-v-77ea2ff0><a href="/" target="_self" class="navbar-brand font-family-headings router-link-active" data-v-77ea2ff0><img src="/assets/img/hack-logo.a62cc95d.png" alt="hack-logo" height="80" data-v-77ea2ff0></a></div><button type="button" aria-label="Toggle navigation" class="navbar-toggler" data-v-77ea2ff0><span class="navbar-toggler-icon"></span></button><div id="nav-collapse" class="navbar-collapse collapse" style="display:none;" data-v-77ea2ff0><ul class="navbar-nav ml-auto align-middle" data-v-77ea2ff0><li class="nav-item text-primary" data-v-77ea2ff0><a href="/#home" target="_self" class="nav-link" data-v-77ea2ff0>Home</a></li><li class="nav-item" data-v-77ea2ff0><a href="#" target="_self" class="nav-link" data-v-77ea2ff0><a href="/case-studies" data-v-77ea2ff0>How to use blockchain</a></a></li><li class="nav-item b-nav-dropdown dropdown dropper" data-v-77ea2ff0><a role="button" aria-haspopup="true" aria-expanded="false" href="#" target="_self" class="nav-link dropdown-toggle"><span>Services</span></a><ul tabindex="-1" class="dropdown-menu dropdown-menu-right"><li role="presentation" data-v-77ea2ff0><a role="menuitem" href="/dlt-blockchain-development-services/blockchain-software-development" target="_self" class="dropdown-item">Blockchain Development</a></li><li role="presentation" data-v-77ea2ff0><a role="menuitem" href="/dlt-blockchain-development-services/smart-contracts-development" target="_self" class="dropdown-item">Smart Contracts Development</a></li><li role="presentation" data-v-77ea2ff0><a role="menuitem" href="/dlt-blockchain-development-services/smart-contract-audits" target="_self" class="dropdown-item">Smart Contract Audits</a></li><li role="presentation" data-v-77ea2ff0><a role="menuitem" href="/dlt-blockchain-development-services/blockchain-consulting" target="_self" class="dropdown-item">Consulting</a></li><li role="presentation" data-v-77ea2ff0><a role="menuitem" href="/dlt-blockchain-development-services/decentralized-applications-development" target="_self" class="dropdown-item">Decentralized application (dApp) development</a></li><li role="presentation" data-v-77ea2ff0><hr role="separator" aria-orientation="horizontal" class="dropdown-divider" data-v-77ea2ff0></li><li role="presentation" data-v-77ea2ff0><a role="menuitem" href="/#services" target="_self" class="dropdown-item">All services</a></li></ul></li><li class="nav-item text-primary" data-v-77ea2ff0><a href="/#about" target="_self" class="nav-link" data-v-77ea2ff0>About us</a></li><li class="nav-item" data-v-77ea2ff0><a href="/blog" target="_self" class="nav-link active" data-v-77ea2ff0>Blog</a></li><li class="nav-item" data-v-77ea2ff0><a href="/#contact" target="_self" class="nav-link" data-v-77ea2ff0><span class="contact" data-v-77ea2ff0>Get in touch</span></a></li></ul></div></nav></header><!----><main><div class="row align-items-start"><main class="bg-white p-0 rounded shadow-lg col-lg-12 col-12"><div class="overflow-hidden p-4 p-sm-5"><article class="row" data-v-a4132618 data-v-a4132618><div data-first="R" class="meta-data py-md-5 text-center position-relative d-flex col-md-3" data-v-a4132618 data-v-a4132618><div class="mx-auto mb-2 position-relative" data-v-a4132618><span class="post-date font-weight-bold" data-v-a4132618>28 Jan 2021</span><i class="d-none d-md-block" data-v-a4132618>in:</i><ul class="list-inline mb-0" data-v-a4132618><li class="list-inline-item m-0"><a href="/category/tutorials/" class="text-uppercase font-weight-bold mx-1">Tutorials</a><!----></li></ul><div data-v-a4132618><i data-v-a4132618>by:</i><a href="/author/milen/" class="font-weight-bold" data-v-a4132618>Milen</a></div></div></div><div class="mb-5 py-md-5 col" data-v-a4132618 data-v-a4132618><header class="mb-4" data-v-a4132618><h1 class="text-break" data-v-a4132618>Running full Bitcoin node over Tor on Ubuntu</h1><img src="https://hack.bg/wp-content/uploads/2021/01/bitcoin_tor.png" alt="" width="1920" class="mt-4 img-fluid" data-v-a4132618></header><div class="post-content text-break" data-v-a4132618>
<h2>00. Why run Bitcoin node? Why Tor?</h2>



<h3>Why Bitcoin full node?</h3>



<p>A full node allows you to participate in the verification of all the transactions and blocks in the Bitcoin network and <a href="https://hack.bg/dlt-blockchain-development-services/blockchain-software-development/" class="rank-math-link">blockchain</a>. Almost all of the full nodes participate in this validation process and relay the transactions and blocks to other nodes they &#8220;know&#8221; (are connected to).</p>



<p>Running a full node helps Bitcoin&#8217;s peer-to-peer network grow and be more decentralized, so clients won&#8217;t have to rely on centralized services for querying the network or transmitting transactions.</p>



<blockquote class="wp-block-quote"><p>Many people and organizations volunteer to run full nodes using spare computing and bandwidth resources—but more volunteers are needed to allow Bitcoin to continue to grow. This document describes how you can help and what helping will cost you. </p><cite>https://bitcoin.org/en/full-node#what-is-a-full-node</cite></blockquote>



<p>Following few steps you will be able to setup a bitcoin full node running on the Tor network (privacy matters).</p>



<h3>Why run on Tor?</h3>



<p>Bitcoin is said to be many things, amongst them anonymity is one of the features to stand out. It is not entirely true the transactions in the network are anonymous, rather pseudonymous, and while it is true that a transaction does not identify a user or wallet, there is a potential for privacy to be partially undermined, by methods that could identify the IP address of a transaction originator.</p>



<p>So if you care about your digital privacy &#8211; keep reading. 🥷</p>



<blockquote class="wp-block-quote"><p><strong>Tor</strong>&nbsp;is&nbsp;<a href="https://en.wikipedia.org/wiki/Free_and_open-source_software">free and open-source software</a>&nbsp;for enabling&nbsp;<a href="https://en.wikipedia.org/wiki/Anonymity">anonymous communication</a>&nbsp;by directing Internet traffic through a free, worldwide, volunteer&nbsp;<a href="https://en.wikipedia.org/wiki/Overlay_network">overlay network</a>&nbsp;consisting of more than seven thousand relays<sup><a href="https://en.wikipedia.org/wiki/Tor_(anonymity_network)#cite_note-torstatus-6">[6]</a></sup>&nbsp;in order to conceal a user&#8217;s location and usage from anyone conducting&nbsp;<a href="https://en.wikipedia.org/wiki/Computer_and_network_surveillance#Network_surveillance">network surveillance</a>&nbsp;or&nbsp;<a href="https://en.wikipedia.org/wiki/Traffic_analysis#In_computer_security">traffic analysis</a>. Using Tor makes it more difficult to trace the Internet activity to the user: this includes &#8220;visits to Web sites, online posts, instant messages, and other communication forms&#8221;.<sup><a href="https://en.wikipedia.org/wiki/Tor_(anonymity_network)#cite_note-nyt-navels-7">[7]</a></sup>&nbsp;Tor&#8217;s intended use is to protect the personal privacy of its users, as well as their freedom and ability to conduct confidential communication by keeping their Internet activities unmonitored.</p><cite>https://en.wikipedia.org/wiki/Tor_(anonymity_network)</cite></blockquote>



<h2>01. Setup SSH</h2>



<p>If you are using a VPS or other cloud machine which you can access via SSH, or your machine already has SSH enabled you can skip this step.</p>



<p>Both <a class="rank-math-link" href="http://ubuntu.com/">Ubuntu</a> 20.04 LTS Desktop and Server come without SSH service enabled by default, which we need to be able to access remotely our machine, but you can easily enable it by just one command.&nbsp;</p>



<pre class="wp-block-code"><code>sudo apt-get install openssh-server</code></pre>



<p>This command will install <a href="http://www.openssh.org/" class="rank-math-link">OpenSSH</a>, which provides free SSH connectivity tools and supports all SSH protocol versions. OpenSSH encrypts all the traffic to eliminate possible eavesdropping, connection hijacking, and other attacks.</p>



<p>Note: The default port for SSH is 22, but you can configure it to run on a port of your choice by editing the config file at <code>/etc/ssh/sshd_config</code>, and apply the changes by restarting the service <code>sudo /etc/init.d/ssh restart</code>.</p>



<p>If you have UFW firewall running on your machine, you will need to allow incoming SSH connections. Type the following command:</p>



<pre class="wp-block-code"><code>sudo ufw allow ssh</code></pre>



<p>After running it you should see the output below.</p>



<pre class="wp-block-code"><code>Output
Rules updated
Rules updated (v6)</code></pre>



<p>Note: If you changed the default SSH port (22) to a custom port, you will need to open that port instead.</p>



<p>For example, if your ssh daemon listens on port&nbsp;<code>4242</code>, then you can use the following command to allow connections on that port:</p>



<pre class="wp-block-code"><code>sudo ufw allow 4242/tcp</code></pre>



<p>Once we are setup with the SSH configuration we can proceed to the real deal.</p>



<h2>02. Install packages</h2>



<p>We need to install some packages needed for compilation of bitcoin&#8217;s source code.</p>



<pre class="wp-block-code"><code>sudo apt-get update
sudo apt-get upgrade
sudo add-apt-repository universe</code></pre>



<p>It&#8217;s possible this is already added, so you might see something like <code>'universe' distribution component is already enabled for all sources.</code> If so &#8211; just ignore it and proceed further.</p>



<pre class="wp-block-code"><code>sudo apt-get install build-essential autoconf libtool pkg-config libboost-all-dev libssl-dev libevent-dev doxygen libzmqpp-dev libdb++-dev</code></pre>



<h2>03. Install BerkelyDB</h2>



<p>Bitcoin Core is still using BerkleyDB 4.8.30 because of backward compatibility. Using a newer versions makes the wallet incompatible with older versions, making downgrade impossible (or at least difficult).</p>



<p>We can do this manually by downloading it via `wget`.</p>



<pre class="wp-block-code"><code>wget http://download.oracle.com/berkeley-db/db-4.8.30.NC.tar.gz</code></pre>



<p>Then verifying the hash of the file:</p>



<pre class="wp-block-code"><code>echo '12edc0df75bf9abd7f82f821795bcee50f42cb2e5f76a6a281b85732798364ef db-4.8.30.NC.tar.gz' | sha256sum -c</code></pre>



<p>Extracting the archive:</p>



<pre class="wp-block-code"><code>tar -xvf db-4.8.30.NC.tar.gz</code></pre>



<p>Configure and build the BerkleyDB for unix</p>



<pre class="wp-block-code"><code>cd db-4.8.30.NC/build_unix</code></pre>



<pre class="wp-block-code"><code>mkdir -p buildBDB_PREFIX=$(pwd)/build../dist/configure --disable-shared --enable-cxx --with-pic --prefix=$BDB_PREFIX</code></pre>



<pre class="wp-block-code"><code>make install</code></pre>



<p>The above may fail with an error similar to this one.</p>



<pre class="wp-block-code"><code>In file included from ../dist/../dbinc/mutex_int.h:12, from ../dist/../dbinc/mutex.h:15, from ./db_int.h:884, from ../dist/../cxx/cxx_db.cpp:11: ../dist/../dbinc/atomic.h:179:19: error: definition of ‘int __atomic_compare_exchange(db_atomic_t*, atomic_value_t, atomic_value_t)’ ambiguates built-in declaration ‘bool __atomic_compare_exchange(long unsigned int, volatile void*, void*, void*, int, int)’ 179 | static inline int __atomic_compare_exchange(</code></pre>



<p>If so you will need to apply some patches for C++11 which are required for the build. The developers at bitcoin have provided a nice shell script which does the downloading, verification and installation of those automatically here <code>https://github.com/bitcoin/bitcoin/blob/master/contrib/install_db4.sh</code>.</p>



<p>So you can fetch and run it like so:</p>



<pre class="wp-block-code"><code>wget https://raw.githubusercontent.com/bitcoin/bitcoin/master/contrib/install_db4.sh
chmod +x install_db4.sh
./install_db4.sh .</code></pre>



<p>After few minutes you should see a message including <code>db4 build complete.</code> </p>



<p>You should also see some more info about flags which you should use for compiling bitcoind (don&#8217;t worry if you did not copy those &#8211; you will find them below).</p>



<h2>04. Compile Bitcoin</h2>



<p>In order to compile bitcoin, we first need to clone the source code repository from Github. </p>



<pre class="wp-block-code"><code>git clone https://github.com/bitcoin/bitcoin.git</code></pre>



<p>We want to checkout a version tag so we don&#8217;t run into problems, building from the <code>master</code> branch, as there the developers are constantly pushing new code.</p>



<pre class="wp-block-code"><code>cd bitcoin
git checkout v0.21.0
git status</code></pre>



<p>After checking out the release tag and running the status check you should see this message:</p>



<pre class="wp-block-code"><code>HEAD detached at v0.21.0
nothing to commit, working tree clean</code></pre>



<p>Now it&#8217;s time for us to build the code.</p>



<pre class="wp-block-code"><code>./autogen.sh</code></pre>



<pre class="wp-block-code"><code>export BDB_PREFIX='${BDB_PREFIX}'
./configure BDB_LIBS="-L${BDB_PREFIX}/lib -ldb_cxx-4.8" BDB_CFLAGS="-I${BDB_PREFIX}/include"</code></pre>



<pre class="wp-block-code"><code>make
make check
sudo make install</code></pre>



<p>We now have successfully compiled bitcoin! 🚀🔥🎉</p>



<h2>05. Configure Bitcoin to use Tor</h2>



<p id="block-38be3746-3589-4fa3-a065-8cd02e28d84d">Before staring syncing the blockchain history we need to configure some settings for our bitcoin node.</p>



<pre id="block-38be3746-3589-4fa3-a065-8cd02e28d84d" class="wp-block-code"><code>cd ~
mkdir .bitcoin
touch .bitcoin/bitcoin.conf
echo "txindex=1" >> .bitcoin/bitcoin.conf</code></pre>



<p>Setting up <code>txindex=1</code> will make Bitcoin rescan the whole blockchain and rebuild the whole database. This can take several days depending on your hardware and internet connection.</p>



<p>If Tor is properly setup in our system bitcoind will be able to communicate to other nodes over Tor network, otherwise it will default for communication over TCP. As we care about our privacy we want to explicitly forbid communication over TCP and allow it to only use Tor. </p>



<pre class="wp-block-code"><code>echo "onlynet=onion" >> .bitcoin/bitcoin.conf</code></pre>



<p>Setup a maximum number of inbound + outbound connections the node can use, so it does not drain your bandwidth.</p>



<pre class="wp-block-code"><code>echo "maxconnections=20" >> .bitcoin/bitcoin.conf</code></pre>



<p>As already mentioned the initial bitcoin blockchain download takes few days to weeks and using Tor will make this time longer as the Tor network is a bottleneck. One reason for that is due to low-bandwidth volunteer-operated Tor routers, but with wider adoption and volunteers running nodes this will change.</p>



<p>Installing Tor on Ubuntu is pretty straightforward and easy:</p>



<pre class="wp-block-code"><code>sudo apt install tor</code></pre>



<p>After the installation is complete we need to check the configuration and ensure we have all of these configurations in <code>/usr/share/tor/tor-service-defaults-torrc</code></p>



<pre class="wp-block-code"><code>ControlPort 9051
CookieAuthentication 1
CookieAuthFileGroupReadable 1</code></pre>



<p>To view the file we can use <code>less</code>:</p>



<pre class="wp-block-code"><code>less /usr/share/tor/tor-service-defaults-torrc</code></pre>



<p>In case any of those configuration settings is missing, use `echo` to add it to the file:</p>



<pre class="wp-block-code"><code>sudo sh -c "echo 'ControlPort 9051' >> /usr/share/tor/tor-service-defaults-torrc"</code></pre>



<pre id="block-38be3746-3589-4fa3-a065-8cd02e28d84d" class="wp-block-preformatted">If you did edit the file, make sure to restart the Tor service:</pre>



<pre class="wp-block-code"><code>sudo /etc/init.d/tor restart</code></pre>



<p>Next step is to allow <code>bitcoind</code> to access to Tor, by adding it to that user group. Replace <code>username</code> with the Ubuntu account username you are operating under.</p>



<pre class="wp-block-code"><code>sudo usermod -a -G debian-tor username</code></pre>



<p>Finally we can launch Bitcoin over Tor: 🙌🥳</p>



<pre class="wp-block-code"><code>bitcoind -daemon</code></pre>



<p>We can follow the logs and monitor progress of the node syncing using <code>tail</code>:</p>



<pre class="wp-block-code"><code>tail -f ~/.bitcoin/debug.log</code></pre>



<p>Fetching <code>getnetworkinfo</code> should result in IPv4 and IPv6 flags set to <code>false</code> and Tor to `true`. This will ensure us that we are operating our node privately.</p>



<pre class="wp-block-code"><code>bitcoin-cli getnetworkinfo</code></pre>



<p>Furthermore, after the sync, we can use <code>bitcoin-cli</code> for querying information for the network status, connections and transaction and blocks information. Get peer info:</p>



<pre class="wp-block-code"><code>bitcoin-cli getpeerinfo | grep true</code></pre>



<p>Inspect a raw transaction:</p>



<pre class="wp-block-code"><code>bitcoin-cli getrawtransaction 0e3e2357e806b6cdb1f70b54c3a3a17b6714ee1f0e68bebb44a74b1efd512098</code></pre>



<p>And inspect the raw output:</p>



<pre class="wp-block-code"><code>01000000010000000000000000000000000000000000000000000000000000000000000000ffffffff0704ffff001d0104ffffffff0100f2052a0100000043410496b538e853519c726a2c91e61ec11600ae1390813a627c66fb8be7947be63c52da7589379515d4e0a604f8141781e62294721166bf621e73a82cbf2342c858eeac00000000</code></pre>



<h2 id="block-26b33e98-5d62-4b3f-901c-2970218ead0e">References and resources</h2>



<ul><li><a href="https://github.com/bitcoin/bitcoin/blob/master/contrib/install_db4.sh " class="rank-math-link">https://github.com/bitcoin/bitcoin/blob/master/contrib/install_db4.sh</a></li><li><a href="https://github.com/bitcoin/bitcoin/issues/18846 " class="rank-math-link">https://github.com/bitcoin/bitcoin/issues/18846</a></li><li><a href="https://github.com/bitcoin/bitcoin/blob/master/depends/packages/bdb.mk#L17 " class="rank-math-link">https://github.com/bitcoin/bitcoin/blob/master/depends/packages/bdb.mk#L17</a></li><li><a href="https://bitcoin.stackexchange.com/questions/79758/bitcoin-built-with-a-newer-berkeley-database-incompatible-with-a-older-wallet " class="rank-math-link">https://bitcoin.stackexchange.com/questions/79758/bitcoin-built-with-a-newer-berkeley-database-incompatible-with-a-older-wallet</a></li><li><a href="https://8bitcoin.medium.com/how-to-run-a-bitcoin-full-node-over-tor-on-an-ubuntu-linux-virtual-machine-bdd7e9415a70 " class="rank-math-link">https://8bitcoin.medium.com/how-to-run-a-bitcoin-full-node-over-tor-on-an-ubuntu-linux-virtual-machine-bdd7e9415a70</a></li><li><a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch03.asciidoc " class="rank-math-link">https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch03.asciidoc</a></li><li><a href="https://www.reddit.com/r/Bitcoin/comments/4y7nc3/create_bitcoin_full_node_with_tor_step_by_step/?st=j5n7z1q1&amp;sh=392084c9" class="rank-math-link">https://www.reddit.com/r/Bitcoin/comments/4y7nc3/create_bitcoin_full_node_with_tor_step_by_step/?st=j5n7z1q1&amp;sh=392084c9</a></li></ul>
</div><h2 class="font-family-sans-serif h4" data-v-a4132618><i class="fa fa-folder-open" data-v-a4132618></i>Categories:
              </h2><ul class="list-inline" data-v-a4132618><li class="list-inline-item" data-v-a4132618><a href="/category/tutorials/" target="_self" class="btn mb-2 btn-primary btn-sm">Tutorials (9)</a></li></ul><h2 class="font-family-sans-serif h4" data-v-a4132618><i class="fa fa-tags" data-v-a4132618></i>Tags:
              </h2><ul class="list-inline" data-v-a4132618><li class="list-inline-item" data-v-a4132618><a href="/tag/bitcoin/" target="_self" class="btn mb-2 btn-primary btn-sm">Bitcoin (4)</a></li><li class="list-inline-item" data-v-a4132618><a href="/tag/blockchain/" target="_self" class="btn mb-2 btn-primary btn-sm">Blockchain (52)</a></li><li class="list-inline-item" data-v-a4132618><a href="/tag/full-node/" target="_self" class="btn mb-2 btn-primary btn-sm">Full node (1)</a></li><li class="list-inline-item" data-v-a4132618><a href="/tag/node/" target="_self" class="btn mb-2 btn-primary btn-sm">Node (1)</a></li><li class="list-inline-item" data-v-a4132618><a href="/tag/tor/" target="_self" class="btn mb-2 btn-primary btn-sm">Tor (1)</a></li></ul></div></article></div></main></div><div class="row mt-5 p-2 newsletter" data-v-102ecac7 data-v-102ecac7><div class="img-container col-sm-3 col-12" data-v-102ecac7><img src="/assets/img/hack_newsletter.7a223066.png" alt="newsletter" width="90%" data-v-102ecac7></div><div class="col" data-v-102ecac7><h3 data-v-102ecac7>Let's build the decentralized future together!</h3><h4 data-v-102ecac7>Subscribe for updates from the blog</h4><form class="form-inline" data-v-102ecac7><fieldset class="form-group" data-v-102ecac7><!----><div tabindex="-1" role="group" class="bv-no-focus-ring"><div class="row" data-v-102ecac7><div class="mb-2 mb-md-0 col" data-v-102ecac7><label for="email" class="sr-only" data-v-102ecac7>E-mail</label><input id="email" type="text" placeholder="Your email" value="" class="mb-2 mr-sm-2 w-100 h-100 form-control" data-v-102ecac7><div aria-hidden="true" style="position:absolute;left:-5000px;" data-v-102ecac7><input type="text" name="b_2f5135b55e33a57f177a0e158_16c540b6e8" tabindex="-1" value="" data-v-102ecac7></div></div><div class="col-md-4 col-12" data-v-102ecac7><button type="submit" class="btn w-100 btn-primary" data-v-102ecac7>Subscribe</button></div></div><!----><!----><!----></div></fieldset><!----><!----><!----></form></div></div><div class="row mt-2"><div id="comments" class="comments-area col"><!----><ol class="comment-list p-0"></ol><div id="respond" class="comment-respond" data-v-783b7f72><form id="commentForm" data-v-783b7f72 data-v-783b7f72><h3 id="reply-title" data-v-783b7f72>
      Leave a Reply
      <small data-v-783b7f72><a color="primary" href="#" target="_self" class="cancel" data-v-783b7f72>Cancel reply</a></small></h3><p data-v-783b7f72>Your email address will not be published. Required fields are marked *</p><label for="comment" data-v-783b7f72>Comment</label><textarea id="comment" required="required" rows="8" wrap="soft" aria-required="true" cols="45" maxlength="65525" class="comment-textarea mb-4 form-control" data-v-783b7f72></textarea><label for="author" data-v-783b7f72>Name *</label><input id="author" type="text" required="required" aria-required="true" maxlength="245" value="" class="comment-input mb-4 form-control" data-v-783b7f72><label for="email" data-v-783b7f72>Email *</label><input id="email" type="email" required="required" aria-required="true" maxlength="100" value="" class="comment-input mb-4 form-control" data-v-783b7f72><button type="submit" class="btn btn-primary" data-v-783b7f72 data-v-783b7f72>Post Comment</button><!----><!----><!----></form></div></div></div></main><!----></div><footer class="bg-white py-5 mt-5" data-v-695cf326><div class="container" data-v-695cf326 data-v-695cf326><hr data-v-695cf326><div class="row" data-v-695cf326 data-v-695cf326><div class="col-lg" data-v-695cf326 data-v-695cf326><img src="/assets/img/hack-logo.a62cc95d.png" alt="hack-logo" width="100%" data-v-695cf326><ul class="flex-wrap" data-v-695cf326><li data-v-695cf326><a href="mailto:hello@hack.bg" title="Get in touch: hello@hack.bg" data-v-695cf326>hello@hack.bg</a></li><li data-v-695cf326><a href="tel:00359898725100" title="Call us: 00 359 898 725 100" data-v-695cf326>00 359 898 725 100</a></li><li data-v-695cf326><abbr title="We are based in Sofia, Bulgaria" data-v-695cf326>Floor 4, 47 Cherni Vrah blvd. Sofia 1407, Bulgaria</abbr></li><li data-v-695cf326><a href="//facebook.com/hackbg" target="_blank" title="hack - facebook page" data-v-695cf326><i class="fab fa-facebook" data-v-695cf326></i></a><a href="//linkedin.com/company/hackbg-blockchain-web-software-solutions" target="_blank" title="hack - linkedin company page" data-v-695cf326><i class="fab fa-linkedin" data-v-695cf326></i></a><a href="//twitter.com/hack_bg" target="_blank" title="hack - twitter company page" data-v-695cf326><i class="fab fa-twitter" data-v-695cf326></i></a><a href="//github.com/hackbg" target="_blank" title="hack - github page" data-v-695cf326><i class="fab fa-github" data-v-695cf326></i></a><a href="//gitter.im/hack-blockchain-development/lobby" target="_blank" title="hack - gitter chat" data-v-695cf326><i class="fab fa-gitter" data-v-695cf326></i></a><a href="//medium.com/hack" target="_blank" title="hack - blog on medium" data-v-695cf326><i class="fab fa-medium" data-v-695cf326></i></a></li></ul></div><div class="col-lg" data-v-695cf326 data-v-695cf326><h2 class="h6 mt-4 mb-2" data-v-695cf326>Services</h2><ul data-v-695cf326><li data-v-695cf326><a href="/dlt-blockchain-development-services/blockchain-software-development/" title="Blockchain Development services" data-v-695cf326>Blockchain Development</a></li><li data-v-695cf326><a href="/dlt-blockchain-development-services/smart-contracts-development/" title="Smart contract development services" data-v-695cf326>Smart Contracts</a></li><li data-v-695cf326><a href="/dlt-blockchain-development-services/smart-contract-audits/" title="Blockchain Consulting and Advisory" data-v-695cf326>Smart contract Audits</a></li><li data-v-695cf326><a href="/dlt-blockchain-development-services/ico-initial-coin-offering/" title="Funrasing and crowsale" data-v-695cf326>Crowdsale</a></li><li data-v-695cf326><a href="/dlt-blockchain-development-services/blockchain-consulting/" title="Blockchain Consulting and Advisory" data-v-695cf326>Consulting</a></li><li data-v-695cf326><a href="/dlt-blockchain-development-services/decentralized-applications-development/" title="Decentralized Applications Consulting and Development" data-v-695cf326>Decentralized Applications Development</a></li></ul></div><div class="col-lg" data-v-695cf326 data-v-695cf326><h2 class="h6 mt-4 mb-2" data-v-695cf326>Products</h2><ul data-v-695cf326><li data-v-695cf326><a href="//github.com/mradkov/vscode-sophia" data-v-695cf326>Sophia VSCode</a></li><li data-v-695cf326><a href="//waellet.com" data-v-695cf326>Waellet</a></li></ul></div><div class="col-lg" data-v-695cf326 data-v-695cf326><h2 class="h6 mt-4 mb-2" data-v-695cf326>Company</h2><ul data-v-695cf326><li data-v-695cf326><a href="/#clients-and-partners" title="Our clients portfolio" data-v-695cf326>Clients and partners</a></li><li data-v-695cf326><a href="/events" title="Events organized by hack" data-v-695cf326>Events</a></li><li data-v-695cf326><a href="/careers" title="Careers at hack" data-v-695cf326>Careers</a></li><li data-v-695cf326><a href="/blog" title="hack - blog" data-v-695cf326>Blog</a></li><li data-v-695cf326><a href="//github.com/hackbg/hack-media-kit/" target="_blank" title="hack media kit" data-v-695cf326>Press</a></li><li data-v-695cf326><a href="/privacy-policy/" title="hack privacy policy" data-v-695cf326>Privacy Policy</a></li></ul></div></div></div><p class="text-center" data-v-695cf326>
    ©
    <a href="https://hack.bg/" data-v-695cf326>hack.bg</a> Ltd - All rights reserved, 2016 - 2020
  </p></footer></div>
    <script>window.__INITIAL_STATE__={"data":{"post":{"id":"2592","title":"Running full Bitcoin node over Tor on Ubuntu","date":"2021-01-28T15:00:48","content":"\n\u003Ch2\u003E00. Why run Bitcoin node? Why Tor?\u003C\u002Fh2\u003E\n\n\n\n\u003Ch3\u003EWhy Bitcoin full node?\u003C\u002Fh3\u003E\n\n\n\n\u003Cp\u003EA full node allows you to participate in the verification of all the transactions and blocks in the Bitcoin network and \u003Ca href=\"https:\u002F\u002Fhack.bg\u002Fdlt-blockchain-development-services\u002Fblockchain-software-development\u002F\" class=\"rank-math-link\"\u003Eblockchain\u003C\u002Fa\u003E. Almost all of the full nodes participate in this validation process and relay the transactions and blocks to other nodes they &#8220;know&#8221; (are connected to).\u003C\u002Fp\u003E\n\n\n\n\u003Cp\u003ERunning a full node helps Bitcoin&#8217;s peer-to-peer network grow and be more decentralized, so clients won&#8217;t have to rely on centralized services for querying the network or transmitting transactions.\u003C\u002Fp\u003E\n\n\n\n\u003Cblockquote class=\"wp-block-quote\"\u003E\u003Cp\u003EMany people and organizations volunteer to run full nodes using spare computing and bandwidth resources—but more volunteers are needed to allow Bitcoin to continue to grow. This document describes how you can help and what helping will cost you. \u003C\u002Fp\u003E\u003Ccite\u003Ehttps:\u002F\u002Fbitcoin.org\u002Fen\u002Ffull-node#what-is-a-full-node\u003C\u002Fcite\u003E\u003C\u002Fblockquote\u003E\n\n\n\n\u003Cp\u003EFollowing few steps you will be able to setup a bitcoin full node running on the Tor network (privacy matters).\u003C\u002Fp\u003E\n\n\n\n\u003Ch3\u003EWhy run on Tor?\u003C\u002Fh3\u003E\n\n\n\n\u003Cp\u003EBitcoin is said to be many things, amongst them anonymity is one of the features to stand out. It is not entirely true the transactions in the network are anonymous, rather pseudonymous, and while it is true that a transaction does not identify a user or wallet, there is a potential for privacy to be partially undermined, by methods that could identify the IP address of a transaction originator.\u003C\u002Fp\u003E\n\n\n\n\u003Cp\u003ESo if you care about your digital privacy &#8211; keep reading. 🥷\u003C\u002Fp\u003E\n\n\n\n\u003Cblockquote class=\"wp-block-quote\"\u003E\u003Cp\u003E\u003Cstrong\u003ETor\u003C\u002Fstrong\u003E&nbsp;is&nbsp;\u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FFree_and_open-source_software\"\u003Efree and open-source software\u003C\u002Fa\u003E&nbsp;for enabling&nbsp;\u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FAnonymity\"\u003Eanonymous communication\u003C\u002Fa\u003E&nbsp;by directing Internet traffic through a free, worldwide, volunteer&nbsp;\u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FOverlay_network\"\u003Eoverlay network\u003C\u002Fa\u003E&nbsp;consisting of more than seven thousand relays\u003Csup\u003E\u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FTor_(anonymity_network)#cite_note-torstatus-6\"\u003E[6]\u003C\u002Fa\u003E\u003C\u002Fsup\u003E&nbsp;in order to conceal a user&#8217;s location and usage from anyone conducting&nbsp;\u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FComputer_and_network_surveillance#Network_surveillance\"\u003Enetwork surveillance\u003C\u002Fa\u003E&nbsp;or&nbsp;\u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FTraffic_analysis#In_computer_security\"\u003Etraffic analysis\u003C\u002Fa\u003E. Using Tor makes it more difficult to trace the Internet activity to the user: this includes &#8220;visits to Web sites, online posts, instant messages, and other communication forms&#8221;.\u003Csup\u003E\u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FTor_(anonymity_network)#cite_note-nyt-navels-7\"\u003E[7]\u003C\u002Fa\u003E\u003C\u002Fsup\u003E&nbsp;Tor&#8217;s intended use is to protect the personal privacy of its users, as well as their freedom and ability to conduct confidential communication by keeping their Internet activities unmonitored.\u003C\u002Fp\u003E\u003Ccite\u003Ehttps:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FTor_(anonymity_network)\u003C\u002Fcite\u003E\u003C\u002Fblockquote\u003E\n\n\n\n\u003Ch2\u003E01. Setup SSH\u003C\u002Fh2\u003E\n\n\n\n\u003Cp\u003EIf you are using a VPS or other cloud machine which you can access via SSH, or your machine already has SSH enabled you can skip this step.\u003C\u002Fp\u003E\n\n\n\n\u003Cp\u003EBoth \u003Ca class=\"rank-math-link\" href=\"http:\u002F\u002Fubuntu.com\u002F\"\u003EUbuntu\u003C\u002Fa\u003E 20.04 LTS Desktop and Server come without SSH service enabled by default, which we need to be able to access remotely our machine, but you can easily enable it by just one command.&nbsp;\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Esudo apt-get install openssh-server\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003EThis command will install \u003Ca href=\"http:\u002F\u002Fwww.openssh.org\u002F\" class=\"rank-math-link\"\u003EOpenSSH\u003C\u002Fa\u003E, which provides free SSH connectivity tools and supports all SSH protocol versions. OpenSSH encrypts all the traffic to eliminate possible eavesdropping, connection hijacking, and other attacks.\u003C\u002Fp\u003E\n\n\n\n\u003Cp\u003ENote: The default port for SSH is 22, but you can configure it to run on a port of your choice by editing the config file at \u003Ccode\u003E\u002Fetc\u002Fssh\u002Fsshd_config\u003C\u002Fcode\u003E, and apply the changes by restarting the service \u003Ccode\u003Esudo \u002Fetc\u002Finit.d\u002Fssh restart\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\n\n\n\n\u003Cp\u003EIf you have UFW firewall running on your machine, you will need to allow incoming SSH connections. Type the following command:\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Esudo ufw allow ssh\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003EAfter running it you should see the output below.\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003EOutput\nRules updated\nRules updated (v6)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003ENote: If you changed the default SSH port (22) to a custom port, you will need to open that port instead.\u003C\u002Fp\u003E\n\n\n\n\u003Cp\u003EFor example, if your ssh daemon listens on port&nbsp;\u003Ccode\u003E4242\u003C\u002Fcode\u003E, then you can use the following command to allow connections on that port:\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Esudo ufw allow 4242\u002Ftcp\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003EOnce we are setup with the SSH configuration we can proceed to the real deal.\u003C\u002Fp\u003E\n\n\n\n\u003Ch2\u003E02. Install packages\u003C\u002Fh2\u003E\n\n\n\n\u003Cp\u003EWe need to install some packages needed for compilation of bitcoin&#8217;s source code.\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Esudo apt-get update\nsudo apt-get upgrade\nsudo add-apt-repository universe\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003EIt&#8217;s possible this is already added, so you might see something like \u003Ccode\u003E'universe' distribution component is already enabled for all sources.\u003C\u002Fcode\u003E If so &#8211; just ignore it and proceed further.\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Esudo apt-get install build-essential autoconf libtool pkg-config libboost-all-dev libssl-dev libevent-dev doxygen libzmqpp-dev libdb++-dev\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Ch2\u003E03. Install BerkelyDB\u003C\u002Fh2\u003E\n\n\n\n\u003Cp\u003EBitcoin Core is still using BerkleyDB 4.8.30 because of backward compatibility. Using a newer versions makes the wallet incompatible with older versions, making downgrade impossible (or at least difficult).\u003C\u002Fp\u003E\n\n\n\n\u003Cp\u003EWe can do this manually by downloading it via `wget`.\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Ewget http:\u002F\u002Fdownload.oracle.com\u002Fberkeley-db\u002Fdb-4.8.30.NC.tar.gz\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003EThen verifying the hash of the file:\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Eecho '12edc0df75bf9abd7f82f821795bcee50f42cb2e5f76a6a281b85732798364ef db-4.8.30.NC.tar.gz' | sha256sum -c\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003EExtracting the archive:\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Etar -xvf db-4.8.30.NC.tar.gz\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003EConfigure and build the BerkleyDB for unix\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Ecd db-4.8.30.NC\u002Fbuild_unix\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Emkdir -p buildBDB_PREFIX=$(pwd)\u002Fbuild..\u002Fdist\u002Fconfigure --disable-shared --enable-cxx --with-pic --prefix=$BDB_PREFIX\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Emake install\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003EThe above may fail with an error similar to this one.\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003EIn file included from ..\u002Fdist\u002F..\u002Fdbinc\u002Fmutex_int.h:12, from ..\u002Fdist\u002F..\u002Fdbinc\u002Fmutex.h:15, from .\u002Fdb_int.h:884, from ..\u002Fdist\u002F..\u002Fcxx\u002Fcxx_db.cpp:11: ..\u002Fdist\u002F..\u002Fdbinc\u002Fatomic.h:179:19: error: definition of ‘int __atomic_compare_exchange(db_atomic_t*, atomic_value_t, atomic_value_t)’ ambiguates built-in declaration ‘bool __atomic_compare_exchange(long unsigned int, volatile void*, void*, void*, int, int)’ 179 | static inline int __atomic_compare_exchange(\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003EIf so you will need to apply some patches for C++11 which are required for the build. The developers at bitcoin have provided a nice shell script which does the downloading, verification and installation of those automatically here \u003Ccode\u003Ehttps:\u002F\u002Fgithub.com\u002Fbitcoin\u002Fbitcoin\u002Fblob\u002Fmaster\u002Fcontrib\u002Finstall_db4.sh\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\n\n\n\n\u003Cp\u003ESo you can fetch and run it like so:\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Ewget https:\u002F\u002Fraw.githubusercontent.com\u002Fbitcoin\u002Fbitcoin\u002Fmaster\u002Fcontrib\u002Finstall_db4.sh\nchmod +x install_db4.sh\n.\u002Finstall_db4.sh .\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003EAfter few minutes you should see a message including \u003Ccode\u003Edb4 build complete.\u003C\u002Fcode\u003E \u003C\u002Fp\u003E\n\n\n\n\u003Cp\u003EYou should also see some more info about flags which you should use for compiling bitcoind (don&#8217;t worry if you did not copy those &#8211; you will find them below).\u003C\u002Fp\u003E\n\n\n\n\u003Ch2\u003E04. Compile Bitcoin\u003C\u002Fh2\u003E\n\n\n\n\u003Cp\u003EIn order to compile bitcoin, we first need to clone the source code repository from Github. \u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Egit clone https:\u002F\u002Fgithub.com\u002Fbitcoin\u002Fbitcoin.git\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003EWe want to checkout a version tag so we don&#8217;t run into problems, building from the \u003Ccode\u003Emaster\u003C\u002Fcode\u003E branch, as there the developers are constantly pushing new code.\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Ecd bitcoin\ngit checkout v0.21.0\ngit status\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003EAfter checking out the release tag and running the status check you should see this message:\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003EHEAD detached at v0.21.0\nnothing to commit, working tree clean\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003ENow it&#8217;s time for us to build the code.\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003E.\u002Fautogen.sh\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Eexport BDB_PREFIX='${BDB_PREFIX}'\n.\u002Fconfigure BDB_LIBS=\"-L${BDB_PREFIX}\u002Flib -ldb_cxx-4.8\" BDB_CFLAGS=\"-I${BDB_PREFIX}\u002Finclude\"\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Emake\nmake check\nsudo make install\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003EWe now have successfully compiled bitcoin! 🚀🔥🎉\u003C\u002Fp\u003E\n\n\n\n\u003Ch2\u003E05. Configure Bitcoin to use Tor\u003C\u002Fh2\u003E\n\n\n\n\u003Cp id=\"block-38be3746-3589-4fa3-a065-8cd02e28d84d\"\u003EBefore staring syncing the blockchain history we need to configure some settings for our bitcoin node.\u003C\u002Fp\u003E\n\n\n\n\u003Cpre id=\"block-38be3746-3589-4fa3-a065-8cd02e28d84d\" class=\"wp-block-code\"\u003E\u003Ccode\u003Ecd ~\nmkdir .bitcoin\ntouch .bitcoin\u002Fbitcoin.conf\necho \"txindex=1\" \u003E\u003E .bitcoin\u002Fbitcoin.conf\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003ESetting up \u003Ccode\u003Etxindex=1\u003C\u002Fcode\u003E will make Bitcoin rescan the whole blockchain and rebuild the whole database. This can take several days depending on your hardware and internet connection.\u003C\u002Fp\u003E\n\n\n\n\u003Cp\u003EIf Tor is properly setup in our system bitcoind will be able to communicate to other nodes over Tor network, otherwise it will default for communication over TCP. As we care about our privacy we want to explicitly forbid communication over TCP and allow it to only use Tor. \u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Eecho \"onlynet=onion\" \u003E\u003E .bitcoin\u002Fbitcoin.conf\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003ESetup a maximum number of inbound + outbound connections the node can use, so it does not drain your bandwidth.\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Eecho \"maxconnections=20\" \u003E\u003E .bitcoin\u002Fbitcoin.conf\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003EAs already mentioned the initial bitcoin blockchain download takes few days to weeks and using Tor will make this time longer as the Tor network is a bottleneck. One reason for that is due to low-bandwidth volunteer-operated Tor routers, but with wider adoption and volunteers running nodes this will change.\u003C\u002Fp\u003E\n\n\n\n\u003Cp\u003EInstalling Tor on Ubuntu is pretty straightforward and easy:\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Esudo apt install tor\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003EAfter the installation is complete we need to check the configuration and ensure we have all of these configurations in \u003Ccode\u003E\u002Fusr\u002Fshare\u002Ftor\u002Ftor-service-defaults-torrc\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003EControlPort 9051\nCookieAuthentication 1\nCookieAuthFileGroupReadable 1\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003ETo view the file we can use \u003Ccode\u003Eless\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Eless \u002Fusr\u002Fshare\u002Ftor\u002Ftor-service-defaults-torrc\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003EIn case any of those configuration settings is missing, use `echo` to add it to the file:\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Esudo sh -c \"echo 'ControlPort 9051' \u003E\u003E \u002Fusr\u002Fshare\u002Ftor\u002Ftor-service-defaults-torrc\"\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cpre id=\"block-38be3746-3589-4fa3-a065-8cd02e28d84d\" class=\"wp-block-preformatted\"\u003EIf you did edit the file, make sure to restart the Tor service:\u003C\u002Fpre\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Esudo \u002Fetc\u002Finit.d\u002Ftor restart\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003ENext step is to allow \u003Ccode\u003Ebitcoind\u003C\u002Fcode\u003E to access to Tor, by adding it to that user group. Replace \u003Ccode\u003Eusername\u003C\u002Fcode\u003E with the Ubuntu account username you are operating under.\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Esudo usermod -a -G debian-tor username\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003EFinally we can launch Bitcoin over Tor: 🙌🥳\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Ebitcoind -daemon\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003EWe can follow the logs and monitor progress of the node syncing using \u003Ccode\u003Etail\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Etail -f ~\u002F.bitcoin\u002Fdebug.log\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003EFetching \u003Ccode\u003Egetnetworkinfo\u003C\u002Fcode\u003E should result in IPv4 and IPv6 flags set to \u003Ccode\u003Efalse\u003C\u002Fcode\u003E and Tor to `true`. This will ensure us that we are operating our node privately.\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Ebitcoin-cli getnetworkinfo\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003EFurthermore, after the sync, we can use \u003Ccode\u003Ebitcoin-cli\u003C\u002Fcode\u003E for querying information for the network status, connections and transaction and blocks information. Get peer info:\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Ebitcoin-cli getpeerinfo | grep true\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003EInspect a raw transaction:\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003Ebitcoin-cli getrawtransaction 0e3e2357e806b6cdb1f70b54c3a3a17b6714ee1f0e68bebb44a74b1efd512098\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003EAnd inspect the raw output:\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code\"\u003E\u003Ccode\u003E01000000010000000000000000000000000000000000000000000000000000000000000000ffffffff0704ffff001d0104ffffffff0100f2052a0100000043410496b538e853519c726a2c91e61ec11600ae1390813a627c66fb8be7947be63c52da7589379515d4e0a604f8141781e62294721166bf621e73a82cbf2342c858eeac00000000\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Ch2 id=\"block-26b33e98-5d62-4b3f-901c-2970218ead0e\"\u003EReferences and resources\u003C\u002Fh2\u003E\n\n\n\n\u003Cul\u003E\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fbitcoin\u002Fbitcoin\u002Fblob\u002Fmaster\u002Fcontrib\u002Finstall_db4.sh\u2028\" class=\"rank-math-link\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fbitcoin\u002Fbitcoin\u002Fblob\u002Fmaster\u002Fcontrib\u002Finstall_db4.sh\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fbitcoin\u002Fbitcoin\u002Fissues\u002F18846\u2028\" class=\"rank-math-link\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fbitcoin\u002Fbitcoin\u002Fissues\u002F18846\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fbitcoin\u002Fbitcoin\u002Fblob\u002Fmaster\u002Fdepends\u002Fpackages\u002Fbdb.mk#L17\u2028\" class=\"rank-math-link\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fbitcoin\u002Fbitcoin\u002Fblob\u002Fmaster\u002Fdepends\u002Fpackages\u002Fbdb.mk#L17\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fbitcoin.stackexchange.com\u002Fquestions\u002F79758\u002Fbitcoin-built-with-a-newer-berkeley-database-incompatible-with-a-older-wallet\u2028\" class=\"rank-math-link\"\u003Ehttps:\u002F\u002Fbitcoin.stackexchange.com\u002Fquestions\u002F79758\u002Fbitcoin-built-with-a-newer-berkeley-database-incompatible-with-a-older-wallet\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Ca href=\"https:\u002F\u002F8bitcoin.medium.com\u002Fhow-to-run-a-bitcoin-full-node-over-tor-on-an-ubuntu-linux-virtual-machine-bdd7e9415a70\u2028\" class=\"rank-math-link\"\u003Ehttps:\u002F\u002F8bitcoin.medium.com\u002Fhow-to-run-a-bitcoin-full-node-over-tor-on-an-ubuntu-linux-virtual-machine-bdd7e9415a70\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fbitcoinbook\u002Fbitcoinbook\u002Fblob\u002Fdevelop\u002Fch03.asciidoc\u2028\" class=\"rank-math-link\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fbitcoinbook\u002Fbitcoinbook\u002Fblob\u002Fdevelop\u002Fch03.asciidoc\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fwww.reddit.com\u002Fr\u002FBitcoin\u002Fcomments\u002F4y7nc3\u002Fcreate_bitcoin_full_node_with_tor_step_by_step\u002F?st=j5n7z1q1&amp;sh=392084c9\" class=\"rank-math-link\"\u003Ehttps:\u002F\u002Fwww.reddit.com\u002Fr\u002FBitcoin\u002Fcomments\u002F4y7nc3\u002Fcreate_bitcoin_full_node_with_tor_step_by_step\u002F?st=j5n7z1q1&amp;sh=392084c9\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\n","excerpt":"\u003Cp\u003E00. Why run Bitcoin node? Why Tor? Why Bitcoin full node? A full node allows you to participate in the [&hellip;]\u003C\u002Fp\u003E\n","link":"https:\u002F\u002Fhack.bg\u002Fblog\u002Ftutorials\u002Frunning-full-bitcoin-node-over-tor-on-ubuntu\u002F","modified":"2021-02-03T10:39:42","featuredMedia":{"sourceUrl":"https:\u002F\u002Fhack.bg\u002Fwp-content\u002Fuploads\u002F2021\u002F01\u002Fbitcoin_tor.png","altText":"","mimeType":"image\u002Fpng","mediaDetails":{"width":1920,"height":1080}},"categories":[{"id":"4","title":"Tutorials","path":"\u002Fcategory\u002Ftutorials\u002F","count":9}],"tags":[{"id":"130","title":"Bitcoin","path":"\u002Ftag\u002Fbitcoin\u002F","count":4},{"id":"13","title":"Blockchain","path":"\u002Ftag\u002Fblockchain\u002F","count":52},{"id":"150","title":"Full node","path":"\u002Ftag\u002Ffull-node\u002F","count":1},{"id":"151","title":"Node","path":"\u002Ftag\u002Fnode\u002F","count":1},{"id":"149","title":"Tor","path":"\u002Ftag\u002Ftor\u002F","count":1}],"author":{"name":"Milen","path":"\u002Fauthor\u002Fmilen\u002F"},"metadata":{"postAudioId":["821cd32a169d467d58ca72c0cf503d67b79bad6a"],"mediumPost":["O:11:\"Medium_Post\":11:{s:16:\"author_image_url\";s:75:\"https:\u002F\u002Fcdn-images-1.medium.com\u002Ffit\u002Fc\u002F400\u002F400\u002F1*uTloDoy725Hwdw-PyJg0Yw.jpeg\";s:10:\"author_url\";s:26:\"https:\u002F\u002Fmedium.com\u002F@radkov\";s:11:\"byline_name\";N;s:12:\"byline_email\";N;s:10:\"cross_link\";s:3:\"yes\";s:2:\"id\";s:12:\"22caff68d6c1\";s:21:\"follower_notification\";s:3:\"yes\";s:7:\"license\";s:19:\"all-rights-reserved\";s:14:\"publication_id\";s:12:\"6c324f156ae9\";s:6:\"status\";s:5:\"draft\";s:3:\"url\";s:39:\"https:\u002F\u002Fmedium.com\u002F@radkov\u002F22caff68d6c1\";}"],"postViewsCount":["107"],"rankMathFocusKeyword":[],"rankMathTitle":[],"rankMathDescription":[]}}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.d0c7a0bb.js" defer></script><script src="/assets/js/page--src--templates--word-press-post-vue.744d2abf.js" defer></script>
  </body>
</html>
