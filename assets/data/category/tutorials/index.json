{"hash":"9e87e5736a4fe29f40d46147d1f7127194213528","data":{"category":{"title":"Tutorials","belongsTo":{"pageInfo":{"totalPages":1,"currentPage":1},"edges":[{"node":{"date":"2020-03-29T21:36:50","id":"1667","title":"From zero to a fully-fledged aeternity decentralized application in less than 10 minutes","path":"/blog/from-zero-to-fully-fledged-decentralized-application-in-less-than-10-minutes/","content":"\n<figure class=\"wp-block-image\"><img loading=\"lazy\" width=\"1024\" height=\"453\" src=\"https://hack.bg/wp-content/uploads/2020/03/Screenshot-2020-03-29-at-21.38.18-2-1024x453.png\" alt=\"\" class=\"wp-image-1775\" srcset=\"https://hack.bg/wp-content/uploads/2020/03/Screenshot-2020-03-29-at-21.38.18-2-1024x453.png 1024w, https://hack.bg/wp-content/uploads/2020/03/Screenshot-2020-03-29-at-21.38.18-2-300x133.png 300w, https://hack.bg/wp-content/uploads/2020/03/Screenshot-2020-03-29-at-21.38.18-2-768x340.png 768w, https://hack.bg/wp-content/uploads/2020/03/Screenshot-2020-03-29-at-21.38.18-2-1038x459.png 1038w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></figure>\n\n\n\n<h2>Intro</h2>\n\n\n\n<p>Let&#8217;s be honest and put the cards down &#8211; if you really need to build a production-ready decentralized application 10 minutes won&#8217;t be nearly enough for sure, and if you are not familiar with the technology you might need some assistance with the <a href=\"https://hack.bg/dlt-blockchain-development-services/smart-contracts-development/\">smart contracts development</a> and setup.  </p>\n\n\n\n<p>Developing such a <a href=\"https://hack.bg/dlt-blockchain-development-services/decentralized-applications-development/\">decentralized application</a> will be a combination of planning and structuring the architecture of the project, drafting and designing the user interface (UI), writing, testing and deploying the smart contracts needed for the dapp to run its business logic … and combining all this together. This also involves a wide variety of technology stack options, depending on the desired outcome and use-case.</p>\n\n\n\n<p>For the purpose of this tutorial though, we will develop an app from scratch to a working decentralized application on aeternity blockchain with a simple frontend.</p>\n\n\n\n<p>Now let the timer start:</p>\n\n\n\n<h3>1. Initialize our project</h3>\n\n\n\n<p>We will use the <a href=\"https://github.com/aeternity/aepp-aeproject-js\">aeproject</a> tool which will allow us to easily set up the development environment locally.</p>\n\n\n\n<ul><li>dependencies<ul><li>docker</li><li>npm &amp; node</li></ul></li></ul>\n\n\n\n<p>Install globally</p>\n\n\n\n<pre class=\"wp-block-code\"><code>npm install -g aeproject</code></pre>\n\n\n\n<p>Initialize project</p>\n\n\n\n<pre class=\"wp-block-code\"><code>aeproject init</code></pre>\n\n\n\n<h3>2. Write our smart contract(s)</h3>\n\n\n\n<p>In this step, we will develop a simple smart contract that is only storing an integer (number) in its state on the blockchain.</p>\n\n\n\n<p>Let&#8217;s also add a getter method which will allow us to read from the contract state.</p>\n\n\n\n<p>Usually, we will do something like this:</p>\n\n\n\n<pre class=\"wp-block-code\"><code>@compiler >= 4\n\ncontract MyContract =\n   record state = { number: int }\n   entrypoint init() : state = { number = 0 }\n   stateful entrypoint set(x: int) = put(state{number = x})\n   stateful entrypoint get() : int = state.number</code></pre>\n\n\n\n<p>In our case, we can further simplify our contract since we are only storing a single integer value. As we know Sophia contracts have restricted mutable state and it is a strongly typed language so we need to define it initially.</p>\n\n\n\n<p>In this case, we can define our <code>state</code> to be of <code>type</code> <code>int</code> as we don&#8217;t need the whole <code>record</code> structure for this:</p>\n\n\n\n<pre class=\"wp-block-code\"><code>@compiler >= 4\n\ncontract MyContract =\n   type state = int\n   entrypoint init() : state = 0\n   stateful entrypoint set(x: int) = put(x)\n   stateful entrypoint get() : int = state</code></pre>\n\n\n\n<p>Here is the same contract, written in Solidity, on Ethereum blockchain just for comparison if you are more familiar with Solidity &#8230; or not:</p>\n\n\n\n<pre class=\"wp-block-code\"><code>pragma solidity >=0.5.0 &lt;0.6.0; \n\ncontract MyContract {\n    uint256 number;\n    constructor() public {\n        number = 0;\n    }\n    function set(uint256 _number) public {\n        number = _number;\n    }\n    function get() public view returns (uint256) {\n        return number;    \n    }\n}</code></pre>\n\n\n\n<h3>3. Deploy</h3>\n\n\n\n<p>In order for us to deploy to an actual <code>testnet</code> or <code>mainnet</code> we need to have some AE tokens on the selected network, so we can pay the mining fee for the transactions we will make to the blockchain.</p>\n\n\n\n<p>Note: We could also deploy it on a local testnet which can be started via <code>aeproject node</code></p>\n\n\n\n<h4>3.1. Create a wallet</h4>\n\n\n\n<p>If we do not yet have a wallet which will be used for deployment we need to generate ourselves one:</p>\n\n\n\n<pre class=\"wp-block-code\"><code>aecli account create &lt;WALLET_NAME></code></pre>\n\n\n\n<pre class=\"wp-block-code\"><code>Note: To quickly test all of Aeternity's blockchain features from your Terminal, you can Install and use our NodeJS CLI by running:\n\nnpm i -g @aeternity/aepp-cli\naecli --help</code></pre>\n\n\n\n<h4>3.2. Fund the wallet</h4>\n\n\n\n<p>We will get some testnet AE tokens from the <a href=\"https://faucet.testnet.aepps.com\">faucet</a>, so we can deploy the contract.</p>\n\n\n\n<h4>3.3. Get our private key</h4>\n\n\n\n<p>We are going to be deploying via the command-line interface (CLI), so we will need to have our private key to pass it to the deployer.</p>\n\n\n\n<p>Get our private key:</p>\n\n\n\n<pre class=\"wp-block-code\"><code>aecli account address &lt;WALLET_NAME> --privateKey</code></pre>\n\n\n\n<h4>3.4. Deploy to testnet</h4>\n\n\n\n<pre class=\"wp-block-code\"><code>aeproject deploy -n testnet -s &lt;SECRET_KEY> --compiler https://latest.compiler.aepps.com</code></pre>\n\n\n\n<h3>4. Interaction with the contract</h3>\n\n\n\n<p>There are multiple we can interact with our contract. The first and most easier is to use one of the online IDEs available out there &#8211; contracts.aeternity.art, fireeditor etc.</p>\n\n\n\n<h4>4.1. Online IDE.</h4>\n\n\n\n<ol><li>contracts.aeternity.art &#8211; we put our contract code in the editor and we can access our contract by adding the address in the <code>&lt;Address&gt;</code> field so we can interact with it.<br> <code>set</code> &#8211; for setting a new value in the smart contract we have to make a stateful call (which modifies the state and costs gas)<br><code>get</code> &#8211; our getter we can access by calling static function.<br></li><li>fireeditor.nikitafuchs.de &#8211; Same as above we can put our contract code and access the freshly deployed contract <strong>at address</strong>.<br></li></ol>\n\n\n\n<h4>4.2. via the SDK</h4>\n\n\n\n<p>We can access our contract instance via this simple command and start interacting with it.</p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>await sdk.getContractInstance(CONTRACT_SOURCE, { contractAddress: OUR_CONTRACT_ADDRESS} );</code></pre>\n\n\n\n<p>Of course we will first have to set up our project and intialize the SDK there.</p>\n\n\n\n<h3>5. Fully-fledged Decentralized app</h3>\n\n\n\n<h4>5.1. Set up frontend</h4>\n\n\n\n<p>In order to setup our simple fronted we will use the waellet boilerplate repo which is pre-configured to communicate with the waellet extension and has the aeternity javascript sdk already prepared there. </p>\n\n\n\n<pre class=\"wp-block-code\"><code>git clone https://github.com/waellet/waellet-aepp-boilerplate &amp;&amp; cd\nnpm install</code></pre>\n\n\n\n<h4>5.2. Add the contract interface (or the full contract code)</h4>\n\n\n\n<p>We need to add our contract interface in the app, so we can call the correct methods and encode the transactions properly. This is similar to the ABI in Solidity for example.</p>\n\n\n\n<figure class=\"wp-block-image\"><img loading=\"lazy\" width=\"1024\" height=\"460\" src=\"https://hack.bg/wp-content/uploads/2020/03/Screenshot-2020-03-19-at-8.06.25-1024x460.png\" alt=\"\" class=\"wp-image-1763\" srcset=\"https://hack.bg/wp-content/uploads/2020/03/Screenshot-2020-03-19-at-8.06.25-1024x460.png 1024w, https://hack.bg/wp-content/uploads/2020/03/Screenshot-2020-03-19-at-8.06.25-300x135.png 300w, https://hack.bg/wp-content/uploads/2020/03/Screenshot-2020-03-19-at-8.06.25-768x345.png 768w, https://hack.bg/wp-content/uploads/2020/03/Screenshot-2020-03-19-at-8.06.25-1038x466.png 1038w, https://hack.bg/wp-content/uploads/2020/03/Screenshot-2020-03-19-at-8.06.25.png 1310w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /><figcaption>https://github.com/waellet/waellet-aepp-boilerplate/blob/23419a910f668069990f96b775bd119aba70f8d3/src/views/Home/Index.vue#L204-L216</figcaption></figure>\n\n\n\n<h4>5.3. Setup function calls </h4>\n\n\n\n<p>We also need to setup the contract methods calls in the app. </p>\n\n\n\n<h4>5.4. run</h4>\n\n\n\n<pre class=\"wp-block-code\"><code>npm run serve</code></pre>\n\n\n\n<p>We can now access our app at <code>localhost:3000</code>:</p>\n\n\n\n<p>We can interact with the contract with the two sample buttons there.</p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"1024\" height=\"909\" src=\"https://hack.bg/wp-content/uploads/2020/03/Screenshot-2020-03-29-at-21.30.41-1024x909.png\" alt=\"\" class=\"wp-image-1769\" srcset=\"https://hack.bg/wp-content/uploads/2020/03/Screenshot-2020-03-29-at-21.30.41-1024x909.png 1024w, https://hack.bg/wp-content/uploads/2020/03/Screenshot-2020-03-29-at-21.30.41-300x266.png 300w, https://hack.bg/wp-content/uploads/2020/03/Screenshot-2020-03-29-at-21.30.41-768x682.png 768w, https://hack.bg/wp-content/uploads/2020/03/Screenshot-2020-03-29-at-21.30.41-649x576.png 649w, https://hack.bg/wp-content/uploads/2020/03/Screenshot-2020-03-29-at-21.30.41.png 1376w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></figure></div>\n","excerpt":"<p>Intro Let&#8217;s be honest and put the cards down &#8211; if you really need to build a production-ready decentralized application 10 minutes won&#8217;t be nearly enough for sure, and if you are not familiar with the technology you might need some assistance with the smart contracts development and setup. Developing such a decentralized application will [&hellip;]</p>\n","categories":[{"id":"53","title":"Tech Talks","path":"/category/blockchain-tech-talks/"},{"id":"4","title":"Tutorials","path":"/category/tutorials/"}],"author":{"name":"Milen Radkov","path":"/author/milen/"}}},{"node":{"date":"2019-10-08T10:08:15","id":"1613","title":"How to create aeternity fungible token? [tutorial]","path":"/blog/how-to-create-aeternity-fungible-token-tutorial/","content":"\n<p>In this short tutorial I&#8217;ll be showing you how to create a fungible token on aeternity blockchain network.</p>\n\n\n\n<p>In this tutorial you will create a AEX-9 (fungible token standard on aeternity) token in few easy steps.<br><br>Prerequisites:</p>\n\n\n\n<ul><li><a href=\"http://waellet.com\">Waellet</a> browser extension</li></ul>\n\n\n\n<p>Note: This will be a short tutorial on creating a fungible token with allowances.</p>\n\n\n\n<h3>Step 1. Go to waellet <code>Utilities</code>  section and select <code>Fungible Tokens</code></h3>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img src=\"https://user-images.githubusercontent.com/13139371/62917304-6ba87880-bda4-11e9-9bc6-247205e70238.png\" alt=\"waellet_1\"/></figure></div>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"358\" height=\"600\" src=\"https://hack.bg/wp-content/uploads/2019/10/Screenshot-2019-10-07-at-9.45.41.png\" alt=\"\" class=\"wp-image-1628\" srcset=\"https://hack.bg/wp-content/uploads/2019/10/Screenshot-2019-10-07-at-9.45.41.png 358w, https://hack.bg/wp-content/uploads/2019/10/Screenshot-2019-10-07-at-9.45.41-179x300.png 179w, https://hack.bg/wp-content/uploads/2019/10/Screenshot-2019-10-07-at-9.45.41-344x576.png 344w\" sizes=\"(max-width: 358px) 100vw, 358px\" /></figure></div>\n\n\n\n<h3>Step 2.  Click <code>Deploy fungible token</code> button.</h3>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img src=\"https://user-images.githubusercontent.com/13139371/62917315-74994a00-bda4-11e9-8617-995a66cd5064.png\" alt=\"waellet_3\"/></figure></div>\n\n\n\n<h3>Step 3. Fill the form with the details needed for the token &#8211;  Token Name, Token Symbol, and decimals.</h3>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img src=\"https://user-images.githubusercontent.com/13139371/62917318-74994a00-bda4-11e9-86fb-78f698c5764d.png\" alt=\"waellet_5\"/></figure></div>\n\n\n\n<h3>Step 4. Click deploy, confirm/sign the transaction and you are ready.</h3>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img src=\"https://user-images.githubusercontent.com/13139371/62917320-7531e080-bda4-11e9-90a2-9dd8ff03baec.png\" alt=\"waellet_7\"/></figure></div>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img src=\"https://user-images.githubusercontent.com/13139371/62917321-7531e080-bda4-11e9-985b-a6b61b0aeb8c.png\" alt=\"waellet_8\"/></figure></div>\n\n\n\n<hr class=\"wp-block-separator\"/>\n\n\n\n<p>The <code>Allowances</code> section of waellet will allow you to interact with the contract and set allowances for addresses of your choice.</p>\n\n\n\n<hr class=\"wp-block-separator\"/>\n\n\n\n<p>The <code>Mint/Burn</code> section allows us to <code>mint</code> (create new tokens) or <code>burn</code> (remove tokens from circulation) tokens.</p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"359\" height=\"605\" src=\"https://hack.bg/wp-content/uploads/2019/10/Screenshot-2019-10-07-at-9.51.09.png\" alt=\"\" class=\"wp-image-1630\" srcset=\"https://hack.bg/wp-content/uploads/2019/10/Screenshot-2019-10-07-at-9.51.09.png 359w, https://hack.bg/wp-content/uploads/2019/10/Screenshot-2019-10-07-at-9.51.09-178x300.png 178w, https://hack.bg/wp-content/uploads/2019/10/Screenshot-2019-10-07-at-9.51.09-342x576.png 342w\" sizes=\"(max-width: 359px) 100vw, 359px\" /></figure></div>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"358\" height=\"600\" src=\"https://hack.bg/wp-content/uploads/2019/10/Screenshot-2019-10-07-at-9.52.55.png\" alt=\"\" class=\"wp-image-1631\" srcset=\"https://hack.bg/wp-content/uploads/2019/10/Screenshot-2019-10-07-at-9.52.55.png 358w, https://hack.bg/wp-content/uploads/2019/10/Screenshot-2019-10-07-at-9.52.55-179x300.png 179w, https://hack.bg/wp-content/uploads/2019/10/Screenshot-2019-10-07-at-9.52.55-344x576.png 344w\" sizes=\"(max-width: 358px) 100vw, 358px\" /></figure></div>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"378\" height=\"604\" src=\"https://hack.bg/wp-content/uploads/2019/10/Screenshot-2019-10-07-at-9.53.08.png\" alt=\"\" class=\"wp-image-1632\" srcset=\"https://hack.bg/wp-content/uploads/2019/10/Screenshot-2019-10-07-at-9.53.08.png 378w, https://hack.bg/wp-content/uploads/2019/10/Screenshot-2019-10-07-at-9.53.08-188x300.png 188w, https://hack.bg/wp-content/uploads/2019/10/Screenshot-2019-10-07-at-9.53.08-360x576.png 360w\" sizes=\"(max-width: 378px) 100vw, 378px\" /></figure></div>\n\n\n\n<p>After confirming the transaction you&#8217;ve successfully minted tokens to the address you specified in the previous step.</p>\n","excerpt":"<p>In this short tutorial I&#8217;ll be showing you how to create a fungible token on aeternity blockchain network. In this tutorial you will create a AEX-9 (fungible token standard on aeternity) token in few easy steps. Prerequisites: Waellet browser extension Note: This will be a short tutorial on creating a fungible token with allowances. Step [&hellip;]</p>\n","categories":[{"id":"53","title":"Tech Talks","path":"/category/blockchain-tech-talks/"},{"id":"4","title":"Tutorials","path":"/category/tutorials/"}],"author":{"name":"Milen Radkov","path":"/author/milen/"}}},{"node":{"date":"2019-03-26T12:22:06","id":"757","title":"How to run your own Aeternity node on Amazon AWS","path":"/blog/how-to-run-your-own-aeternity-node-on-amazon-aws/","content":"\n<p>Hey there,</p>\n\n\n\n<p>So you are new to <g class=\"gr_ gr_3 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del multiReplace\" id=\"3\" data-gr-id=\"3\"><g class=\"gr_ gr_3 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del multiReplace\" id=\"3\" data-gr-id=\"3\"><a href=\"http://aeternity.com\">aeternity</a></g></g> blockchain and want to run a node of your own, but you don&#8217;t have powerful enough hardware or you don&#8217;t want to bully your laptop.</p>\n\n\n\n<p>After thinking a while you decide to run it on an Amazon AWS VPS instance, but you are not sure how to set everything up &#8211; well you&#8217;ve come to the right place.</p>\n\n\n\n<p>After registering, setting up your account and logging in for the first time you are presented with this AWS Management Console screen. </p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"1024\" height=\"640\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.24.00-1024x640.png\" alt=\"\" class=\"wp-image-758\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.24.00-1024x640.png 1024w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.24.00-300x188.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.24.00-768x480.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.24.00-922x576.png 922w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.24.00.png 1280w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></figure></div>\n\n\n\n<p>Scroll down a bit and select &#8220;<strong>Launch a virtual machine</strong>&#8220;.</p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"1024\" height=\"640\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.24.19-1024x640.png\" alt=\"\" class=\"wp-image-759\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.24.19-1024x640.png 1024w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.24.19-300x188.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.24.19-768x480.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.24.19-922x576.png 922w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.24.19.png 1280w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></figure></div>\n\n\n\n<p>Then in the search bar type &#8220;ubuntu&#8221; and hit enter.</p>\n\n\n\n<p>Aeternity has a node release for ubuntu so Ubuntu 18.04 will be best suitable for the purpose of launching our own node without much headaches.</p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"1024\" height=\"640\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.24.59-1024x640.png\" alt=\"\" class=\"wp-image-760\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.24.59-1024x640.png 1024w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.24.59-300x188.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.24.59-768x480.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.24.59-922x576.png 922w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.24.59.png 1280w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></figure></div>\n\n\n\n<p>After the search loads, we select Ubuntu Server 18.04 (the first one).</p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"1024\" height=\"640\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.25.24-1024x640.png\" alt=\"\" class=\"wp-image-761\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.25.24-1024x640.png 1024w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.25.24-300x188.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.25.24-768x480.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.25.24-922x576.png 922w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.25.24.png 1280w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></figure></div>\n\n\n\n<p>As you may know, Amazon gives you 12 months of free tier usage for some of its services and as it happens t2.micro tier <g class=\"gr_ gr_4 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del multiReplace\" id=\"4\" data-gr-id=\"4\">vps</g> type is eligible for this.</p>\n\n\n\n<p><strong>BUT</strong></p>\n\n\n\n<p>It is worth mentioning that if we choose the free tier we won&#8217;t have enough CPU time (<g class=\"gr_ gr_5 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del multiReplace\" id=\"5\" data-gr-id=\"5\">amazon</g> has limited the <g class=\"gr_ gr_7 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del multiReplace\" id=\"7\" data-gr-id=\"7\">cpu</g> time that the free tier can use) to sync with the whole <g class=\"gr_ gr_112 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del multiReplace\" id=\"112\" data-gr-id=\"112\">aeternity</g> blockchain.</p>\n\n\n\n<p>So we now have a few options here:</p>\n\n\n\n<ul><li>proceed with the free t2.micro tier, sync the blockchain on our local pc and then upload it to the AWS instance </li><li>proceed with the free t2.micro tier, set everything up and then upgrade the tier when we hit the CPU time limit</li><li>or the easiest one &#8211; just select t3.nano or above we are good to go (it won&#8217;t cost <g class=\"gr_ gr_5 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del\" id=\"5\" data-gr-id=\"5\">us</g> much, as it charges only on usage).</li></ul>\n\n\n\n<p>For the purpose of this tutorial I will be proceeding with the second option as it will give you a better overview of the whole procedure than the rest.</p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"1024\" height=\"640\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.25.36-1024x640.png\" alt=\"\" class=\"wp-image-762\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.25.36-1024x640.png 1024w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.25.36-300x188.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.25.36-768x480.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.25.36-922x576.png 922w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.25.36.png 1280w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></figure></div>\n\n\n\n<p>After selecting the tier type we click &#8220;Review and Launch&#8221; button to continue.<br></p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"1024\" height=\"640\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.26.16-1024x640.png\" alt=\"\" class=\"wp-image-764\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.26.16-1024x640.png 1024w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.26.16-300x188.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.26.16-768x480.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.26.16-922x576.png 922w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.26.16.png 1280w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></figure></div>\n\n\n\n<p>Then we click the &#8220;Launch&#8221; button. We are being asked to choose a keypair that will be used for SSH-ing into the instance or create a new one.</p>\n\n\n\n<p>Select &#8220;Create a new key pair&#8221; and then name it as you like. I named mine <code>aeternity</code>, so if you&#8217;ve selected another name, adjust the next commands accordingly. </p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"1024\" height=\"640\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.26.40-1024x640.png\" alt=\"\" class=\"wp-image-765\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.26.40-1024x640.png 1024w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.26.40-300x188.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.26.40-768x480.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.26.40-922x576.png 922w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.26.40.png 1280w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /><figcaption><br></figcaption></figure></div>\n\n\n\n<p>Download the key pair and click &#8220;Launch instance&#8221;.</p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"1024\" height=\"640\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.26.58-1024x640.png\" alt=\"\" class=\"wp-image-766\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.26.58-1024x640.png 1024w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.26.58-300x188.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.26.58-768x480.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.26.58-922x576.png 922w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.26.58.png 1280w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></figure></div>\n\n\n\n<p>Our new vps instance is now launching.</p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"1024\" height=\"640\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.27.15-1024x640.png\" alt=\"\" class=\"wp-image-767\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.27.15-1024x640.png 1024w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.27.15-300x188.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.27.15-768x480.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.27.15-922x576.png 922w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.27.15.png 1280w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></figure></div>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"1024\" height=\"640\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.27.18-1024x640.png\" alt=\"\" class=\"wp-image-768\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.27.18-1024x640.png 1024w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.27.18-300x188.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.27.18-768x480.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.27.18-922x576.png 922w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.27.18.png 1280w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></figure></div>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"1024\" height=\"640\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.27.38-1024x640.png\" alt=\"\" class=\"wp-image-769\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.27.38-1024x640.png 1024w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.27.38-300x188.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.27.38-768x480.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.27.38-922x576.png 922w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.27.38.png 1280w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></figure></div>\n\n\n\n<p>While waiting for our AWS EC2 instance to fire, we can visit the <a href=\"http://github.com/aeternity/aeternity\">Aeternity blockchain Github repo</a> and search for the latest <g class=\"gr_ gr_3 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del multiReplace\" id=\"3\" data-gr-id=\"3\">aeternity</g> node <a href=\"http://github.com/aeternity/aeternity/releases/latest\">release</a>.</p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"1024\" height=\"640\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.27.50-1024x640.png\" alt=\"\" class=\"wp-image-770\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.27.50-1024x640.png 1024w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.27.50-300x188.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.27.50-768x480.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.27.50-922x576.png 922w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.27.50.png 1280w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></figure></div>\n\n\n\n<p>Our AWS instance is already up and running. Now we need to connect to it via SSH and start setting up our aeternity node.</p>\n\n\n\n<p>Select the instance and click &#8220;Connect&#8221;.</p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"1024\" height=\"640\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.28.53-1024x640.png\" alt=\"\" class=\"wp-image-771\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.28.53-1024x640.png 1024w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.28.53-300x188.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.28.53-768x480.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.28.53-922x576.png 922w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.28.53.png 1280w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></figure></div>\n\n\n\n<p>We are now provided with instructions on how to connect to our vps via SSH. If you are using Windows machine &#8211; you can use PuTTY or another SSH client that you are used to.</p>\n\n\n\n<p>I&#8217;m running on OSx, so I will proceed with the tutorial via Mac&#8217;s terminal. It should be the same so don&#8217;t worry.</p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"1024\" height=\"640\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.29.03-1024x640.png\" alt=\"\" class=\"wp-image-772\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.29.03-1024x640.png 1024w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.29.03-300x188.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.29.03-768x480.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.29.03-922x576.png 922w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.29.03.png 1280w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></figure></div>\n\n\n\n<p>Amazon asks us to change the<code>chmod</code>level of the file so the first thing we do is:</p>\n\n\n\n<p><code>chmod 400 aeternity.pem</code></p>\n\n\n\n<p>Note that the key pair file I&#8217;ve downloaded to my home folder so if you&#8217;ve downloaded your somewhere else &#8211; adjust this accordingly to your path.</p>\n\n\n\n<p>The next command also should be adjusted according to your <code>.pem</code> file location and the public DNS that Amazon provided for your instance.</p>\n\n\n\n<p>You should be able to see the exact commands on the screen above.</p>\n\n\n\n<p><code>ssh -i \"aeternity.pem\" ubuntu@ec2-54-159-117.255.compute-1.amazonaws.com</code></p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"920\" height=\"581\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.29.38.png\" alt=\"\" class=\"wp-image-773\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.29.38.png 920w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.29.38-300x189.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.29.38-768x485.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.29.38-912x576.png 912w\" sizes=\"(max-width: 920px) 100vw, 920px\" /></figure></div>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"920\" height=\"581\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.31.11.png\" alt=\"\" class=\"wp-image-774\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.31.11.png 920w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.31.11-300x189.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.31.11-768x485.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.31.11-912x576.png 912w\" sizes=\"(max-width: 920px) 100vw, 920px\" /></figure></div>\n\n\n\n<p>Now we are into our fresh launched Amazon AWS instance.</p>\n\n\n\n<p>In order for us to run aeternity node on Ubuntu 18.04 we need to install a few libraries beforehand.</p>\n\n\n\n<p><code>sudo apt-get install libsodium23</code></p>\n\n\n\n<p><code>sudo apt-get install libssl1.0.0</code></p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"920\" height=\"598\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.31.51.png\" alt=\"\" class=\"wp-image-775\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.31.51.png 920w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.31.51-300x195.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.31.51-768x499.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.31.51-886x576.png 886w\" sizes=\"(max-width: 920px) 100vw, 920px\" /></figure></div>\n\n\n\n<p>Then we download the latest node release from the aeternity&#8217;s github that we checked in the beginning.</p>\n\n\n\n<p><code>wget https://github.com/aeternity/aeternity/releases/download/v5.5.0/aeternity-5.5.0-ubuntu-x86_64.tar.gz</code></p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"920\" height=\"598\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.41.44.png\" alt=\"\" class=\"wp-image-776\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.41.44.png 920w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.41.44-300x195.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.41.44-768x499.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.41.44-886x576.png 886w\" sizes=\"(max-width: 920px) 100vw, 920px\" /></figure></div>\n\n\n\n<p>We need to create a directory where our aeternity node will be placed:</p>\n\n\n\n<p><code>mkdir aeternity</code></p>\n\n\n\n<p>and then extract the release archive in it:</p>\n\n\n\n<p> <code>tar -xvzf aeternity-5.5.0-ubuntu-x86_64.tar.gz -C aeternity</code></p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"920\" height=\"598\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.43.35.png\" alt=\"\" class=\"wp-image-780\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.43.35.png 920w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.43.35-300x195.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.43.35-768x499.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.43.35-886x576.png 886w\" sizes=\"(max-width: 920px) 100vw, 920px\" /></figure></div>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"920\" height=\"598\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.43.54.png\" alt=\"\" class=\"wp-image-781\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.43.54.png 920w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.43.54-300x195.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.43.54-768x499.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.43.54-886x576.png 886w\" sizes=\"(max-width: 920px) 100vw, 920px\" /></figure></div>\n\n\n\n<p>Enter the directory via <code>cd aeternity</code>.</p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"920\" height=\"598\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.43.58.png\" alt=\"\" class=\"wp-image-782\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.43.58.png 920w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.43.58-300x195.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.43.58-768x499.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.43.58-886x576.png 886w\" sizes=\"(max-width: 920px) 100vw, 920px\" /></figure></div>\n\n\n\n<p>We now can start our aeternity node via:</p>\n\n\n\n<p><code>bin/aeternity start</code></p>\n\n\n\n<p>As you can see we can get a warning related to the maximum number of open files, so we execute <code>ulimit -n 24576</code> and then start again.</p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"920\" height=\"598\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.46.03.png\" alt=\"\" class=\"wp-image-784\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.46.03.png 920w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.46.03-300x195.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.46.03-768x499.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.46.03-886x576.png 886w\" sizes=\"(max-width: 920px) 100vw, 920px\" /></figure></div>\n\n\n\n<p>For stopping the node we execute <code>bin/aeternity stop</code></p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"920\" height=\"598\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.46.13.png\" alt=\"\" class=\"wp-image-785\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.46.13.png 920w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.46.13-300x195.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.46.13-768x499.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.46.13-886x576.png 886w\" sizes=\"(max-width: 920px) 100vw, 920px\" /></figure></div>\n\n\n\n<p>If we want to see if our node is up and running we can make a simple <code>curl</code> request:</p>\n\n\n\n<p><code>curl http://127.0.0.1:3013/v2/blocks/top</code></p>\n\n\n\n<p>If you get some JSON like this &#8211; it means we are good to go.</p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"920\" height=\"598\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.46.53.png\" alt=\"\" class=\"wp-image-786\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.46.53.png 920w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.46.53-300x195.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.46.53-768x499.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.46.53-886x576.png 886w\" sizes=\"(max-width: 920px) 100vw, 920px\" /></figure></div>\n\n\n\n<p>As you can notice the Aeternity node is working on TCP port <code>3013</code> so we need to allow that in our instance&#8217;s network settings.</p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"1024\" height=\"645\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.50.01-1024x645.png\" alt=\"\" class=\"wp-image-787\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.50.01-1024x645.png 1024w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.50.01-300x189.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.50.01-768x484.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.50.01-914x576.png 914w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.50.01.png 1386w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></figure></div>\n\n\n\n<p>We select the instance then click &#8220;Actions&#8221; and navigate to &#8220;Networking&#8221; -&gt; &#8220;Change Security Groups&#8221;.</p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"1024\" height=\"645\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.50.33-1024x645.png\" alt=\"\" class=\"wp-image-788\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.50.33-1024x645.png 1024w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.50.33-300x189.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.50.33-768x484.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.50.33-914x576.png 914w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.50.33.png 1386w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></figure></div>\n\n\n\n<p>We create <g class=\"gr_ gr_4 gr-alert gr_gramm gr_inline_cards gr_run_anim Grammar only-ins replaceWithoutSep\" id=\"4\" data-gr-id=\"4\">new</g> security group called &#8220;<g class=\"gr_ gr_3 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del multiReplace\" id=\"3\" data-gr-id=\"3\">aeternity</g>&#8221; and add new Custom TCP rule in the Inbound traffic tab for the <g class=\"gr_ gr_57 gr-alert gr_gramm gr_inline_cards gr_run_anim Style multiReplace\" id=\"57\" data-gr-id=\"57\">port </g><code>3013</code><g class=\"gr_ gr_57 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"57\" data-gr-id=\"57\">.</g></p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"1024\" height=\"645\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.51.07-1024x645.png\" alt=\"\" class=\"wp-image-789\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.51.07-1024x645.png 1024w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.51.07-300x189.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.51.07-768x484.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.51.07-914x576.png 914w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.51.07.png 1386w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></figure></div>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"1024\" height=\"645\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.51.19-1024x645.png\" alt=\"\" class=\"wp-image-790\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.51.19-1024x645.png 1024w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.51.19-300x189.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.51.19-768x484.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.51.19-914x576.png 914w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.51.19.png 1386w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></figure></div>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"1024\" height=\"645\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.52.11-1024x645.png\" alt=\"\" class=\"wp-image-792\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.52.11-1024x645.png 1024w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.52.11-300x189.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.52.11-768x484.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.52.11-914x576.png 914w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.52.11.png 1386w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></figure></div>\n\n\n\n<p>Then we add this to our instance.</p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"1024\" height=\"645\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.52.30-1024x645.png\" alt=\"\" class=\"wp-image-791\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.52.30-1024x645.png 1024w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.52.30-300x189.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.52.30-768x484.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.52.30-914x576.png 914w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.52.30.png 1386w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></figure></div>\n\n\n\n<p>We can check if it&#8217;s working by accessing it in our browser at the following address:<br><br><code>our_instance_public_dns_that_amazon_provided_for_us:3013/v2/status</code></p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"1024\" height=\"645\" src=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.52.38-1024x645.png\" alt=\"\" class=\"wp-image-793\" srcset=\"https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.52.38-1024x645.png 1024w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.52.38-300x189.png 300w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.52.38-768x484.png 768w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.52.38-914x576.png 914w, https://hack.bg/wp-content/uploads/2019/03/Screenshot-2019-03-14-at-16.52.38.png 1386w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></figure></div>\n\n\n\n<p>You now have a running Aeternity node on AWS. Cheers ! 🙂</p>\n","excerpt":"<p>Hey there, So you are new to aeternity blockchain and want to run a node of your own, but you don&#8217;t have powerful enough hardware or you don&#8217;t want to bully your laptop. After thinking a while you decide to run it on an Amazon AWS VPS instance, but you are not sure how to [&hellip;]</p>\n","categories":[{"id":"4","title":"Tutorials","path":"/category/tutorials/"},{"id":"53","title":"Tech Talks","path":"/category/blockchain-tech-talks/"}],"author":{"name":"Milen Radkov","path":"/author/milen/"}}},{"node":{"date":"2019-01-28T09:36:38","id":"433","title":"How to setup our environment for developing on Ethereum","path":"/blog/how-to-setup-our-environment-for-developing-on-ethereum/","content":"\n<p class=\"has-drop-cap\">There are lots of tutorials on the Internet for developing decentralized applications, smart contracts and write unit test with Solidity on the Ethereum blockchain. Including a <a href=\"https://hack.bg/category/blog/tutorials/\">few of our own</a>, for that matter. </p>\n\n\n\n<p>BUT a large part of them lack the initial environment setup, that is needed for someone just arriving in the blockchain space with a bag full of questions, wondering where the heck to start from. </p>\n\n\n\n<p>So, after a series of questions received regarding this topic, I&#8217;m writing this, hoping, to help you out setup your ethereum solidity development environment if you are completely new to this space.</p>\n\n\n\n<hr class=\"wp-block-separator\"/>\n\n\n\n<h2>Prerequisites</h2>\n\n\n\n<ul><li>Windows, macOS, Linux computer or laptop</li><li>Internet connection</li><li>patience &#8230; 🙂</li></ul>\n\n\n\n<hr class=\"wp-block-separator\"/>\n\n\n\n<h2>macOS <g class=\"gr_ gr_34 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling\" id=\"34\" data-gr-id=\"34\">se</g>tup<br></h2>\n\n\n\n<p>For macOS, ensure that you have the latest version of\n<a href=\"https://developer.apple.com/xcode/download/\">Xcode installed</a>.\nThis contains the <a href=\"https://en.wikipedia.org/wiki/Clang\">Clang C++ compiler</a>, the\n<a href=\"https://en.wikipedia.org/wiki/Xcode\">Xcode IDE</a> and other Apple development\ntools which are required for building C++ applications on OS X.\nIf you are installing Xcode for the first time, or have just installed a new\nversion then you will need to agree to the license before you can do\ncommand-line builds:</p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>sudo xcodebuild -license accept</code></pre>\n\n\n\n<p>Ethereum Solidity OS X builds require you have <a href=\"http://brew.sh\">Homebrew</a> package manager installed for installing external dependencies.</p>\n\n\n\n<p>Install Homebrew:</p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>/usr/bin/ruby -e \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)\"</code></pre>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>brew update</code></pre>\n\n\n\n<p>Install node and NPM (Node Package Manager) using brew &#8211; npm will be automatically installed with node:</p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>brew install node</code></pre>\n\n\n\n<p>Then we can proceed with installing <code>solc</code> which is the Solidity command-line compiler.</p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>npm install -g solc</code></pre>\n\n\n\n<p>After that we install <code>truffle</code> framework and <code>ganache-cli</code> which will be our primary tools for compiling, testing and deployment.</p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>npm install -g truffle</code></pre>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>npm install -g ganache-cli</code></pre>\n\n\n\n<hr class=\"wp-block-separator\"/>\n\n\n\n<h2>Windows setup</h2>\n\n\n\n<p>We need to install several things for a windows environment. The first one is git for windows &#8211; it&#8217;s a command-line tool for retrieving source code from Github. <g class=\"gr_ gr_112 gr-alert gr_gramm gr_inline_cards gr_run_anim Punctuation only-ins replaceWithoutSep\" id=\"112\" data-gr-id=\"112\">Next</g> we need to have CMake installed, which is a cross-platform build file generator. And last we have to have a C++ compiler which we can get from Visual Studio Build Tools. The links for these three are below:</p>\n\n\n\n<ul><li><a href=\"https://git-scm.com/download/win\">Git for <g class=\"gr_ gr_48 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del multiReplace\" id=\"48\" data-gr-id=\"48\">Windows</g></a></li><li><a href=\"https://cmake.org/download/\">CMake</a></li><li><a href=\"https://www.visualstudio.com/downloads/#build-tools-for-visual-studio-2017\">Visual Studio 2017 Build Tools</a></li></ul>\n\n\n\n<p>After <g class=\"gr_ gr_3 gr-alert gr_gramm gr_inline_cards gr_run_anim Punctuation only-ins replaceWithoutSep\" id=\"3\" data-gr-id=\"3\">that</g> we can proceed with installing node and <g class=\"gr_ gr_5 gr-alert gr_gramm gr_inline_cards gr_run_anim Style multiReplace\" id=\"5\" data-gr-id=\"5\">then </g><code>solc</code><g class=\"gr_ gr_5 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"5\" data-gr-id=\"5\"> <g class=\"gr_ gr_14 gr-alert gr_gramm gr_inline_cards gr_run_anim Punctuation only-del replaceWithoutSep\" id=\"14\" data-gr-id=\"14\"><g class=\"gr_ gr_63 gr-alert gr_gramm gr_inline_cards gr_run_anim Punctuation only-del replaceWithoutSep\" id=\"63\" data-gr-id=\"63\">,</g></g></g><g class=\"gr_ gr_14 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Punctuation only-del replaceWithoutSep\" id=\"14\" data-gr-id=\"14\"><g class=\"gr_ gr_63 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Punctuation only-del replaceWithoutSep\" id=\"63\" data-gr-id=\"63\"> </g></g><code>truffle</code><g class=\"gr_ gr_14 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Punctuation only-del replaceWithoutSep\" id=\"14\" data-gr-id=\"14\"><g class=\"gr_ gr_63 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Punctuation only-del replaceWithoutSep\" id=\"63\" data-gr-id=\"63\"> ,</g></g> <code>ganache-cli</code> like shown in the macOS setup.</p>\n\n\n\n<blockquote class=\"wp-block-quote\"><p><br> Then we can proceed with installing <code>solc</code> which is the Solidity command-line compiler.<br> <br> <br> <code>npm install -g solc</code><br> <br> <br> After that we install <code>truffle</code> framework and <code>ganache-cli</code> which will be our primary tools for compiling, testing and deployment.<br> <br> <br> <code>npm install -g truffle</code><br> <br> <br> <code>npm install -g ganache-cli</code> </p></blockquote>\n","excerpt":"<p>There are lots of tutorials on the Internet for developing decentralized applications, smart contracts and write unit test with Solidity on the Ethereum blockchain. Including a few of our own, for that matter. BUT a large part of them lack the initial environment setup, that is needed for someone just arriving in the blockchain space [&hellip;]</p>\n","categories":[{"id":"4","title":"Tutorials","path":"/category/tutorials/"},{"id":"53","title":"Tech Talks","path":"/category/blockchain-tech-talks/"}],"author":{"name":"Milen Radkov","path":"/author/milen/"}}},{"node":{"date":"2019-01-23T20:11:11","id":"533","title":"Building Voting æpp with Sophia ML on æternity blockchain","path":"/blog/building-voting-aepp-with-sophia-ml-on-aeternity-blockchain/","content":"\n<p>Time is passing by and we are getting more experienced in writing smart contracts with Sophia ML language on æ<g class=\"gr_ gr_8 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del multiReplace\" id=\"8\" data-gr-id=\"8\">ternity</g> blockchain.</p>\n\n\n\n<p>In this tutorial, I&#8217;d like to share with you a simple voting decentralized <g class=\"gr_ gr_3 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del multiReplace\" id=\"3\" data-gr-id=\"3\">aepp</g> solution that we&#8217;ve built during the æpps summit in Turkey, which I took part in.</p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"960\" height=\"540\" src=\"https://hack.bg/wp-content/uploads/2019/01/aepps-summit.jpg\" alt=\"\" class=\"wp-image-542\" srcset=\"https://hack.bg/wp-content/uploads/2019/01/aepps-summit.jpg 960w, https://hack.bg/wp-content/uploads/2019/01/aepps-summit-300x169.jpg 300w, https://hack.bg/wp-content/uploads/2019/01/aepps-summit-768x432.jpg 768w\" sizes=\"(max-width: 960px) 100vw, 960px\" /><figcaption>photo by nikita fuchs</figcaption></figure></div>\n\n\n\n<p>This was one of my first times interacting with Sophia ML smart contracts, and while at the æpps summit I&#8217;ve gathered some cool and enthusiastic people, and made ourselves sort of a studying group. We decided to brainstorm and learn together while developing this voting <g class=\"gr_ gr_6 gr-alert gr_spell gr_inline_cards gr_disable_anim_appear ContextualSpelling ins-del multiReplace\" id=\"6\" data-gr-id=\"6\">aepp</g>. This is the short summary of what we&#8217;ve decided our voting <g class=\"gr_ gr_7 gr-alert gr_spell gr_inline_cards gr_disable_anim_appear ContextualSpelling ins-del multiReplace\" id=\"7\" data-gr-id=\"7\">aepp</g> will be doing:</p>\n\n\n\n<ol><li>Add candidates to vote for</li><li>Allow users to give their vote for a certain candidate</li><li>Count the votes that every candidate gathered</li></ol>\n\n\n\n<p class=\"note\">You can <g class=\"gr_ gr_5 gr-alert gr_gramm gr_inline_cards gr_run_anim Grammar only-ins replaceWithoutSep\" id=\"5\" data-gr-id=\"5\">try</g> push the <g class=\"gr_ gr_3 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del multiReplace\" id=\"3\" data-gr-id=\"3\">aepp&#8217;s</g> functionalities further, with more sophisticated functions and use case, you can try doing it <g class=\"gr_ gr_7 gr-alert gr_gramm gr_inline_cards gr_run_anim Punctuation only-del replaceWithoutSep\" id=\"7\" data-gr-id=\"7\">yourself,</g> <g class=\"gr_ gr_25 gr-alert gr_gramm gr_inline_cards gr_run_anim Grammar multiReplace\" id=\"25\" data-gr-id=\"25\">like</g> we did. Try it &#8211; its fun.</p>\n\n\n\n<h2>Setting up project and development <g class=\"gr_ gr_109 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del multiReplace gr-progress\" id=\"109\" data-gr-id=\"109\">environment</g></h2>\n\n\n\n<p><g class=\"gr_ gr_5 gr-alert gr_gramm gr_inline_cards gr_run_anim Punctuation only-ins replaceWithoutSep\" id=\"5\" data-gr-id=\"5\">First</g> we have to initialize our project where we will write <g class=\"gr_ gr_4 gr-alert gr_gramm gr_inline_cards gr_run_anim Grammar multiReplace\" id=\"4\" data-gr-id=\"4\">the smart</g> contract. In order to do that we will be using <code>forgae</code>. Take a look at the <a href=\"https://hack.bg/blog/tutorials/build-your-first-decentralized-application-aepp-on-aeternity-blockchain-sophia-smart-contract-address-book/\">Build first </a><g class=\"gr_ gr_92 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del multiReplace\" id=\"92\" data-gr-id=\"92\"><a href=\"https://hack.bg/blog/tutorials/build-your-first-decentralized-application-aepp-on-aeternity-blockchain-sophia-smart-contract-address-book/\">aeternity</a></g><a href=\"https://hack.bg/blog/tutorials/build-your-first-decentralized-application-aepp-on-aeternity-blockchain-sophia-smart-contract-address-book/\"> application with Sophia ML tutorial</a> and follow the steps to initialize your project.</p>\n\n\n\n<h2>Smart contract</h2>\n\n\n\n<p>As you probably already know (if you&#8217;ve followed the previous tutorial), in <g class=\"gr_ gr_3 gr-alert gr_gramm gr_inline_cards gr_run_anim Punctuation only-ins replaceWithoutSep\" id=\"3\" data-gr-id=\"3\">Sophia</g> ML we have a <strong>state</strong> which is the place where we store data on-chain, and it is the only thing in the smart contract that can be mutated (overwritten).</p>\n\n\n\n<p>The first thing we do is to define our variables and types that we are going to use in the smart contract. And <g class=\"gr_ gr_217 gr-alert gr_gramm gr_inline_cards gr_run_anim Style multiReplace\" id=\"217\" data-gr-id=\"217\">the </g><code>init()</code><g class=\"gr_ gr_217 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"217\" data-gr-id=\"217\"> function</g> which is the constructor basically, if we compare this to a Solidity smart contract.</p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>contract Vote =\n   type candidate = address\n   type votes = list(address)\n\n   record state = \n      { vote : map(candidate, votes) }\n\n   public function init() : state = \n      { vote = { } }</code></pre>\n\n\n\n<p>We are defining <g class=\"gr_ gr_263 gr-alert gr_gramm gr_inline_cards gr_run_anim Style multiReplace\" id=\"263\" data-gr-id=\"263\">the </g><code>candidate</code><g class=\"gr_ gr_263 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"263\" data-gr-id=\"263\"> type</g> as address, and votes as a <strong>list</strong> of addresses. And the <code>state</code> record will be storing a map (key-value-pair) of <code>candidate</code> to <code>votes</code>.<br></p>\n\n\n\n<p><del>Starting with the first functionality for the aepp &#8211; adding candidates:</del></p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code><del>  public stateful function add_candidate(candidate: address) : bool =       is_candidate(candidate)       true</del></code></pre>\n\n\n\n<p><del>What this does is passing the candidate to the </del><code><del>is_candiate()</del></code><del> function &#8211; taking a candidate&#8217;s address as a parameter, checking if there is a candidate defined at with this address and saving it to the </del><strong><del>votes</del></strong><del> mapping in the state with the initial empty list of voters if not.</del><br></p>\n\n\n\n<p><del>Here are the helper functions we are using for this:</del></p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code><del>   private stateful function is_candidate(candidate: address) =       let candidate_found = lookupByAddress(candidate, state.votes, { voters = [] })       if (size(candidate_found.voters) == 0)          put(state{             votes[candidate] = { voters = [] } })    private function lookupByAddress(k : address, m, v) =       switch(Map.lookup(k,m))          None => v          Some(x) => x</del></code></pre>\n\n\n\n<p>We are doing this because in Sophia ML we don&#8217;t have a default value of 0x0/false as in Solidity for example. So, in order for us to cast a vote, we need to first have added the candidates which we can vote for.</p>\n\n\n\n<p class=\"note\">If we don&#8217;t add the candidate first, before voting, we will hit <code>out of gas</code> error.</p>\n\n\n\n<p>Next we create the vote function which looks like this:</p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>public stateful function vote(vote_for: candidate) =\n      put(state{ vote[vote_for = []] @ vs = Call.caller :: vs })</code></pre>\n\n\n\n<p>We access the transaction initiator&#8217;s address by the <g class=\"gr_ gr_3 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del multiReplace\" id=\"3\" data-gr-id=\"3\">built </g><g class=\"gr_ gr_4 gr-alert gr_gramm gr_inline_cards gr_run_anim Style multiReplace\" id=\"4\" data-gr-id=\"4\"><g class=\"gr_ gr_3 gr-alert gr_spell gr_inline_cards gr_disable_anim_appear ContextualSpelling ins-del multiReplace\" id=\"3\" data-gr-id=\"3\">in</g> </g><code>Call.caller</code><g class=\"gr_ gr_4 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"4\" data-gr-id=\"4\"> and</g> prepend <g class=\"gr_ gr_5 gr-alert gr_gramm gr_inline_cards gr_run_anim Style multiReplace\" id=\"5\" data-gr-id=\"5\">it </g><code>::</code><g class=\"gr_ gr_5 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"5\" data-gr-id=\"5\"> to</g> the current list of voters. Using this <g class=\"gr_ gr_23 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del multiReplace\" id=\"23\" data-gr-id=\"23\">syntx</g> we <g class=\"gr_ gr_32 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del multiReplace\" id=\"32\" data-gr-id=\"32\">dont</g> need to worry whether the candidate was initialized or not.</p>\n\n\n\n<p><g class=\"gr_ gr_9 gr-alert gr_gramm gr_inline_cards gr_run_anim Grammar only-ins replaceWithoutSep\" id=\"9\" data-gr-id=\"9\">Last</g> thing is the get votes count function.</p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>public function count_votes(count_for : candidate) =\n      length(state.vote[count_for = []])</code></pre>\n\n\n\n<p>Here we are using a custom <code>length</code> function which we define as a helper function below. Here is the code and below we can see the explanation.</p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>private function length(l : list('a)) : int = length'(l, 0)\n</code></pre>\n\n\n\n<p>This is where things get a bit more complicated, so I will try to explain what is happening here.</p>\n\n\n\n<p>Since in Sophia ML we don&#8217;t have <code>.count</code> or <code>.length</code> to get the list length, we need to make ourselves a helper function which will make a recursion and will iterate over the list while incrementing a counter.</p>\n\n\n\n<p>The <code>length</code> function is defined to accept a list <g class=\"gr_ gr_9 gr-alert gr_gramm gr_inline_cards gr_run_anim Style multiReplace\" id=\"9\" data-gr-id=\"9\">of </g><code>'a</code><g class=\"gr_ gr_9 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"9\" data-gr-id=\"9\"> which</g> is the convention for a generic <g class=\"gr_ gr_5 gr-alert gr_gramm gr_inline_cards gr_run_anim Punctuation only-del replaceWithoutSep\" id=\"5\" data-gr-id=\"5\">type,</g> and a return <g class=\"gr_ gr_11 gr-alert gr_gramm gr_inline_cards gr_run_anim Style multiReplace\" id=\"11\" data-gr-id=\"11\">type </g><code>int</code><g class=\"gr_ gr_11 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"11\" data-gr-id=\"11\"> .</g> In the function&#8217;s <g class=\"gr_ gr_6 gr-alert gr_gramm gr_inline_cards gr_run_anim Punctuation only-ins replaceWithoutSep\" id=\"6\" data-gr-id=\"6\">body</g> we are calling <g class=\"gr_ gr_10 gr-alert gr_gramm gr_inline_cards gr_run_anim Style multiReplace\" id=\"10\" data-gr-id=\"10\">the </g><code>length'</code><g class=\"gr_ gr_10 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"10\" data-gr-id=\"10\"> </g><g class=\"gr_ gr_7 gr-alert gr_gramm gr_inline_cards gr_run_anim Punctuation only-del replaceWithoutSep\" id=\"7\" data-gr-id=\"7\"><g class=\"gr_ gr_10 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"10\" data-gr-id=\"10\">function</g>,</g> while passing the list and an initial value for the counter.</p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>private function length'(l : list('a), x : int) : int =       switch(l)          [] => x          _ :: l' => length'(l', x + 1)</code></pre>\n\n\n\n<p>And here the magic happens, we use <g class=\"gr_ gr_6 gr-alert gr_gramm gr_inline_cards gr_run_anim Style multiReplace\" id=\"6\" data-gr-id=\"6\">the </g><code>switch</code><g class=\"gr_ gr_6 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"6\" data-gr-id=\"6\"> statement</g> with 2 cases <code>[] => x</code> &#8211; which returns the value of the counter and breaks the recursion if the list is empty. And <code>_ :: l' => length'(l', x+1)</code> &#8211; meaning we are using a pattern matching and we are separating the first element from the list and the remainder and then recursively passing the list&#8217;s remainder to the same <g class=\"gr_ gr_5 gr-alert gr_gramm gr_inline_cards gr_run_anim Punctuation only-del replaceWithoutSep\" id=\"5\" data-gr-id=\"5\">function,</g> while incrementing the counter.</p>\n\n\n\n<p>The whole smart contract code looks like this in the end</p>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/d05aeb76c59e2098d54dc900e94aaa41.js\"></script><figcaption>Sophia ML basic voting aepp</figcaption></figure>\n\n\n\n<h2>Conclusion</h2>\n\n\n\n<p>It is fairly simple to create a basic aepp on æternity blockchain using Sophia ML. In our case with the ae-vote we stumbled upon some tricky parts like the recursive iteration, we had to make above, but when you familiarize yourself with the language it is easier.</p>\n\n\n\n<h3>Useful links</h3>\n\n\n\n<ul><li><a href=\"https://github.com/mradkov/ae-vote\">Github repo of the project</a></li><li><a href=\"https://github.com/aeternity/protocol/blob/master/contracts/sophia.md\">Sophia documentation</a></li><li><a href=\"https://dev.aepps.com/\">æternity documentation</a></li></ul>\n","excerpt":"<p>Time is passing by and we are getting more experienced in writing smart contracts with Sophia ML language on æternity blockchain. In this tutorial, I&#8217;d like to share with you a simple voting decentralized aepp solution that we&#8217;ve built during the æpps summit in Turkey, which I took part in. This was one of my [&hellip;]</p>\n","categories":[{"id":"4","title":"Tutorials","path":"/category/tutorials/"},{"id":"53","title":"Tech Talks","path":"/category/blockchain-tech-talks/"}],"author":{"name":"Milen Radkov","path":"/author/milen/"}}},{"node":{"date":"2019-01-10T10:59:33","id":"449","title":"Build your first decentralized application (aepp) on Aeternity blockchain &#8211; Sophia ML smart contract &#8211; Address Book","path":"/blog/build-your-first-decentralized-application-aepp-on-aeternity-blockchain-sophia-smart-contract-address-book/","content":"\n<figure class=\"wp-block-image\"><img loading=\"lazy\" width=\"1024\" height=\"576\" src=\"https://hack.bg/wp-content/uploads/2019/01/sveta_sofia_aeternity-1024x576.jpg\" alt=\"Sophia aeternity\" class=\"wp-image-500\" srcset=\"https://hack.bg/wp-content/uploads/2019/01/sveta_sofia_aeternity-1024x576.jpg 1024w, https://hack.bg/wp-content/uploads/2019/01/sveta_sofia_aeternity-300x169.jpg 300w, https://hack.bg/wp-content/uploads/2019/01/sveta_sofia_aeternity-768x432.jpg 768w, https://hack.bg/wp-content/uploads/2019/01/sveta_sofia_aeternity-1025x576.jpg 1025w, https://hack.bg/wp-content/uploads/2019/01/sveta_sofia_aeternity.jpg 1334w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /><figcaption>Sophia aeternity</figcaption></figure>\n\n\n\n<p class=\"has-drop-cap has-text-align-left\">Æternity blockchain is live after long period of waiting, the community is big and the core developers are top skilled. The project offers smart contracts development platform for decentralized applications dapps or how they call them &#8211; æpps.</p>\n\n\n\n<p class=\"has-text-align-left\">In this tutorial we are going to create a simple smart contract in Sophia ML programming language &#8211; address book <g class=\"gr_ gr_4 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del multiReplace\" id=\"4\" data-gr-id=\"4\">aepp</g>. We will create, compile, test and deploy the smart contract.<br></p>\n\n\n\n<h2>Prerequisites</h2>\n\n\n\n<ul><li><a href=\"https://docs.docker.com/compose/install/\">Docker</a></li><li><s>Forgae</s> <a href=\"https://www.npmjs.com/package/aeproject\">AEproject</a></li><li><a href=\"https://github.com/aeternity/aepp-cli-js\">Aecli</a> * (optional if we want to do something with the sdk like encode/decode address by publicKey or signTx)</li></ul>\n\n\n\n<p class=\"has-text-align-left\">Docker we need for running local aeternity node for compiling, testing and development environment. Assuming you already have <g class=\"gr_ gr_52 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del multiReplace\" id=\"52\" data-gr-id=\"52\">docker</g> installed on your machine we move on, if not &#8211; please follow the guide in their official website and then continue with the steps below.</p>\n\n\n\n<p class=\"has-text-align-left\"><g class=\"gr_ gr_6 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del multiReplace\" id=\"6\" data-gr-id=\"6\"><s>Forgae</s> AEproject</g> is <g class=\"gr_ gr_14 gr-alert gr_gramm gr_inline_cards gr_run_anim Grammar multiReplace\" id=\"14\" data-gr-id=\"14\">an æternity</g> development framework which helps with setting up a project. The framework makes the development of smart contracts in the <g class=\"gr_ gr_8 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del multiReplace\" id=\"8\" data-gr-id=\"8\">aeternity</g> network pretty easily. It provides commands for the compilation of smart contracts, running a local Epoch and unit testing the contracts.<br></p>\n\n\n\n<p class=\"has-text-align-left\">We install it globally via:</p>\n\n\n\n<pre><code>npm install -g aeproject</code></pre>\n\n\n\n<p class=\"has-text-align-left\">After installing <s>forgae</s> AEproject we can verify everything went well with <code>aeproject --help</code> which will also get us familiarize with the commands and options it has.</p>\n\n\n\n<pre><code>Usage: aeproject [options] [command]\n\nOptions:\n  -V, --version      output the version number\n  -h, --help         output usage information\n\nCommands:\n  init [options]     Initialize AEProject\n  compile [options]  Compile contracts\n  test [options]     Running the tests\n  node [options]     Running a local node. Without any argument node will be runned with --start argument\n  deploy [options]   Run deploy script</code></pre>\n\n\n\n<p class=\"has-text-align-left\">We are almost done with the setup. The last tool we need is <code>aecli</code> which is æternity&#8217;s JavaScript SDK command-line interface. It is still not available as <g class=\"gr_ gr_693 gr-alert gr_gramm gr_inline_cards gr_run_anim Grammar multiReplace\" id=\"693\" data-gr-id=\"693\">a <g class=\"gr_ gr_691 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del multiReplace\" id=\"691\" data-gr-id=\"691\">npm</g></g> package, so for us to use it we should clone the repository, install from source and then link it to our local <g class=\"gr_ gr_587 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling\" id=\"587\" data-gr-id=\"587\">npm</g> manually.<br></p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>git clone https://github.com/aeternity/aepp-cli-js.git</code></pre>\n\n\n\n<p class=\"has-text-align-left\">We then need to enter into the cloned repository with:</p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>cd aepp-cli-js</code></pre>\n\n\n\n<p class=\"has-text-align-left\">Run <code>npm link</code> in order to link the AECLI to <code>aecli/bin/aecli.js</code> (<em>If you have any folder permission issues, try running with sudo <code>sudo npm link</code></em>)</p>\n\n\n\n<blockquote class=\"wp-block-quote has-text-align-left\"><p><code>npm link</code> <g class=\"gr_ gr_3 gr-alert gr_gramm gr_inline_cards gr_run_anim Grammar only-ins doubleReplace replaceWithoutSep\" id=\"3\" data-gr-id=\"3\">command</g> will create a symlink in the global node_modules folder and expose the CLI binary to be used through the terminal.</p><cite>npm link</cite></blockquote>\n\n\n\n<p class=\"has-text-align-left\">and lastly we should run<code>npm install</code> so npm update its packages and symlinks.</p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>npm install</code></pre>\n\n\n\n<p class=\"has-text-align-left\">Now if everything went well our environment is set and ready to start developing sophia smart contracts on æternity. </p>\n\n\n\n<h3>Project init</h3>\n\n\n\n<p class=\"has-text-align-left\">As always, first we need to create a directory where our project files will be placed:</p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>mkdir addressbook-aepp</code><br><code>cd addressbook-aepp</code></pre>\n\n\n\n<p class=\"has-text-align-left\">Then we initialize our project with <code>aeproject init</code> which will create for us all the necessary files and directories.</p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>aeproject init</code></pre>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"837\" height=\"587\" src=\"https://hack.bg/wp-content/uploads/2019/01/forgae-init-aepp.png\" alt=\"Initialization of aeternity aepp with forgae\" class=\"wp-image-461\" srcset=\"https://hack.bg/wp-content/uploads/2019/01/forgae-init-aepp.png 837w, https://hack.bg/wp-content/uploads/2019/01/forgae-init-aepp-300x210.png 300w, https://hack.bg/wp-content/uploads/2019/01/forgae-init-aepp-768x539.png 768w, https://hack.bg/wp-content/uploads/2019/01/forgae-init-aepp-821x576.png 821w\" sizes=\"(max-width: 837px) 100vw, 837px\" /><figcaption>Initialization of aeternity aepp with forgae</figcaption></figure></div>\n\n\n\n<p class=\"has-text-align-left\">If we look at our project directory we will see that we now have <strong>contracts</strong>, <strong>deployment</strong>, <strong>test</strong> directories where our focus will mainly be, as well as other config files like package.json and docker-compose.yml.</p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"837\" height=\"587\" src=\"https://hack.bg/wp-content/uploads/2019/01/forgae-init-project-directory.png\" alt=\"forgae init project directory\" class=\"wp-image-470\" srcset=\"https://hack.bg/wp-content/uploads/2019/01/forgae-init-project-directory.png 837w, https://hack.bg/wp-content/uploads/2019/01/forgae-init-project-directory-300x210.png 300w, https://hack.bg/wp-content/uploads/2019/01/forgae-init-project-directory-768x539.png 768w, https://hack.bg/wp-content/uploads/2019/01/forgae-init-project-directory-821x576.png 821w\" sizes=\"(max-width: 837px) 100vw, 837px\" /><figcaption>forgae init project directory</figcaption></figure></div>\n\n\n\n<p class=\"has-text-align-left\">Now we need to <strong>start docker</strong> and then start our local node with:</p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>aeproject node</code></pre>\n\n\n\n<blockquote class=\"wp-block-quote has-text-align-left\"><p>The <strong>node</strong> command help developers run their <g class=\"gr_ gr_11 gr-alert gr_gramm gr_inline_cards gr_run_anim Style multiReplace\" id=\"11\" data-gr-id=\"11\">local  network</g> on docker. The local network contains 3 nodes. To spawn a fully functional <g class=\"gr_ gr_12 gr-alert gr_gramm gr_inline_cards gr_run_anim Style multiReplace\" id=\"12\" data-gr-id=\"12\">network  takes</g> <g class=\"gr_ gr_8 gr-alert gr_gramm gr_inline_cards gr_run_anim Grammar only-ins replaceWithoutSep\" id=\"8\" data-gr-id=\"8\">couple</g> of minutes. At the end of this <g class=\"gr_ gr_9 gr-alert gr_gramm gr_inline_cards gr_run_anim Punctuation only-ins replaceWithoutSep\" id=\"9\" data-gr-id=\"9\">command</g> you will <g class=\"gr_ gr_13 gr-alert gr_gramm gr_inline_cards gr_run_anim Style multiReplace\" id=\"13\" data-gr-id=\"13\">be  presented</g> with accounts that you can use in your unit tests.</p><cite>documentation</cite></blockquote>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"837\" height=\"587\" src=\"https://hack.bg/wp-content/uploads/2019/01/forgae-node.png\" alt=\"forgae node initialized successfully\" class=\"wp-image-468\" srcset=\"https://hack.bg/wp-content/uploads/2019/01/forgae-node.png 837w, https://hack.bg/wp-content/uploads/2019/01/forgae-node-300x210.png 300w, https://hack.bg/wp-content/uploads/2019/01/forgae-node-768x539.png 768w, https://hack.bg/wp-content/uploads/2019/01/forgae-node-821x576.png 821w\" sizes=\"(max-width: 837px) 100vw, 837px\" /><figcaption>forgae node initialized successfully</figcaption></figure></div>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"837\" height=\"587\" src=\"https://hack.bg/wp-content/uploads/2019/01/forgae-node-funding.png\" alt=\"forgae node gives us preset test accounts\" class=\"wp-image-469\" srcset=\"https://hack.bg/wp-content/uploads/2019/01/forgae-node-funding.png 837w, https://hack.bg/wp-content/uploads/2019/01/forgae-node-funding-300x210.png 300w, https://hack.bg/wp-content/uploads/2019/01/forgae-node-funding-768x539.png 768w, https://hack.bg/wp-content/uploads/2019/01/forgae-node-funding-821x576.png 821w\" sizes=\"(max-width: 837px) 100vw, 837px\" /><figcaption>forgae node gives us preset test accounts</figcaption></figure></div>\n\n\n\n<p class=\"has-text-align-left\">To stop the local node, simply run</p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>aeproject node --stop</code></pre>\n\n\n\n<p>Additionally we need to start the local compiler the same way as we start the node.</p>\n\n\n\n<p><code>aeproject compiler</code></p>\n\n\n\n<h2>Write Sophia ML smart contracts</h2>\n\n\n\n<p class=\"has-text-align-left\">When we initialized our project with <code>aeproject init</code> it automatically created for us an <code>ExampleContract.aes</code> file, which name speaks for what it is. Its content looks like this:<br></p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>@compiler &gt;= 4\ncontract ExampleContract =\n    type state = ()\n    function main(x : int) = x</code></pre>\n\n\n\n<p class=\"has-text-align-left\">This example contract has one function which accepts a single argument of <g class=\"gr_ gr_4 gr-alert gr_gramm gr_inline_cards gr_run_anim Style multiReplace\" id=\"4\" data-gr-id=\"4\">type </g><code>int</code><g class=\"gr_ gr_4 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"4\" data-gr-id=\"4\"> and</g> returns the value of the passed <g class=\"gr_ gr_5 gr-alert gr_gramm gr_inline_cards gr_run_anim Style multiReplace\" id=\"5\" data-gr-id=\"5\">argument </g><code>x</code><g class=\"gr_ gr_5 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"5\" data-gr-id=\"5\">.</g></p>\n\n\n\n<p class=\"has-text-align-left\">If this is your first time looking at Sophia smart contract, you probably notice that it is quite different from Solidity for example, and looks much similar to Python. </p>\n\n\n\n<p class=\"has-text-align-left\"><g class=\"gr_ gr_4 gr-alert gr_spell gr_inline_cards gr_disable_anim_appear ContextualSpelling ins-del multiReplace\" id=\"4\" data-gr-id=\"4\">Aeternity&#8217;s</g> Sophia is <g class=\"gr_ gr_5 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Grammar multiReplace\" id=\"5\" data-gr-id=\"5\">a ML</g>-family language. It is strongly typed and has restricted mutable state. <a href=\"https://github.com/aeternity/protocol/blob/master/contracts/sophia.md\">Sophia</a> is developed to be used for creating smart contracts on Aeternity Blockchain, so some of the conventional languages&#8217; features are missing, but other blockchain specific primitives, types and constructions are added and supported.</p>\n\n\n\n<p class=\"has-text-align-left\">Okay, we move on to the fun part. We now hit the delete button and get rid of the <code>ExampleContract.aes</code>. </p>\n\n\n\n<p class=\"has-text-align-left\">We create our <code>AddressBook.aes</code> sophia smart contract in the <code>contracts</code>folder and open it with our favorite editor (in my case VIM).</p>\n\n\n\n<p class=\"has-text-align-left\">We define the name of our smart contract, following the example above:</p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>contract AddressBook =<br><br></code></pre>\n\n\n\n<p class=\"note\">Note: Indentation is important in Sophia language, so keep that in mind.</p>\n\n\n\n<p class=\"has-text-align-left\">Sophia uses Python-style layout rules to group declarations and statements. A\nlayout block with more than one element must start on a separate line and be\nindented more than the currently enclosing layout block. Blocks with a single\nelement can be written on the same line as the previous token.</p>\n\n\n\n<p class=\"has-text-align-left\">Each element of the block must share the same indentation and no part of an element may be indented less than the indentation of the block.</p>\n\n\n\n<p class=\"has-text-align-left\">Okay, the first thing we do after that is defining our person and state records and create the <code>init</code>function.<br></p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>@compiler >= 4\ncontract AddressBook =\n\n   record person =\n     { first_name : string\n     , last_name : string\n     , age : int }\n\n   record state  = { people : map(address, person) }\n\n   entrypoint init() = { people = {} }</code></pre>\n\n\n\n<p class=\"has-text-align-left\">Let us focus on some info from the sophia documentation so we know what we&#8217;ve done so far:</p>\n\n\n\n<p class=\"has-text-align-left\">Sophia does not have arbitrary mutable state, but only a limited form of\nstate associated with each contract instance.</p>\n\n\n\n<ul><li>Each contract defines a type <code>state</code> encapsulating its mutable state.</li><li>The initial state of a contract is computed by the contract&#8217;s <code>init</code>\nfunction. The <code>init</code> function is <em>pure</em> and returns the initial state as its\nreturn value. At contract creation time, the <code>init</code> function is executed and\nits result is stored as the contract state.</li><li>The value of the state is accessible from inside the contract\nthrough an implicitly bound variable <code>state</code>.</li><li>State updates are performed by calling a function <code>put : state =&gt; ()</code>.</li><li>Aside from the <code>put</code> function (and similar functions for transactions\nand events), the language is purely functional.</li><li>Functions modifying the state need to be annotated with the <code>stateful</code> keyword.</li></ul>\n\n\n\n<blockquote class=\"wp-block-quote has-text-align-left\"><p>A contract may define a type state encapsulating its local state. The state must be initialised when instantiating a contract. This is done by the init function which can take arbitrary arguments and is called on contract instance creation.<br></p><cite>sophia documentation</cite></blockquote>\n\n\n\n<p class=\"has-text-align-left\">We now have to create setter function for saving person&#8217;s details, and getter functions for getting them.</p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>   stateful entrypoint add_person(person_address: address, first_name': string, last_name': string, age: int) =\n      let new_person : person =\n         { first_name = first_name',\n           last_name = last_name',\n           age = age }\n      put(state{ people[person_address] = new_person })</code></pre>\n\n\n\n<p class=\"has-text-align-left\"><s>For</s> our <s>getter </s><g class=\"gr_ gr_31 gr-alert gr_gramm gr_inline_cards gr_run_anim Punctuation only-ins replaceWithoutSep\" id=\"31\" data-gr-id=\"31\"><s>functions</s></g><s> we will need a helper function which will allow us to easily search in </s><g class=\"gr_ gr_149 gr-alert gr_gramm gr_inline_cards gr_run_anim Grammar only-del replaceWithoutSep\" id=\"149\" data-gr-id=\"149\"><s>the </s></g><code>map</code><g class=\"gr_ gr_149 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Grammar only-del replaceWithoutSep\" id=\"149\" data-gr-id=\"149\"> <s>we</s></g><s>&#8216;ve created</s>.</p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code><strike>function lookupByAddress(k : address, m, v) =\n      switch(Map.lookup(k, m))\n         None    =&gt; v\n         Some(x) =&gt; x</strike></code></pre>\n\n\n\n<p class=\"has-text-align-left\">and our getters:</p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>   entrypoint get_person(person_address : <em>address</em>) : person = \n      switch(Map.lookup(person_address, <em>state</em>.people))\n         <em>None</em> =&gt; abort(\"No data for that person\")\n         <em>Some</em>(person_found) =&gt; person_found</code></pre>\n\n\n\n<p class=\"has-text-align-left\">Now we are done with the smart contract. It should look like this:</p>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/87bd736e39440155873a973426a548a8.js\"></script><figcaption>AddressBook.aes &#8211; aeternity smart contract</figcaption></figure>\n\n\n\n<h2>Compile Sophia ML contracts</h2>\n\n\n\n<p class=\"has-text-align-left\">Compiling sophia smart contracts is done via:</p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>aeproject compile</code></pre>\n\n\n\n<p class=\"has-text-align-left\">And if everything went well we should see a similar output</p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"793\" height=\"543\" src=\"https://hack.bg/wp-content/uploads/2019/01/forgae-compile-output.png\" alt=\"Compiling sophia smart contract\" class=\"wp-image-486\" srcset=\"https://hack.bg/wp-content/uploads/2019/01/forgae-compile-output.png 793w, https://hack.bg/wp-content/uploads/2019/01/forgae-compile-output-300x205.png 300w, https://hack.bg/wp-content/uploads/2019/01/forgae-compile-output-768x526.png 768w\" sizes=\"(max-width: 793px) 100vw, 793px\" /><figcaption>Compiling sophia smart contract</figcaption></figure></div>\n\n\n\n<blockquote class=\"wp-block-quote has-text-align-left\"><p><g class=\"gr_ gr_14 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"14\" data-gr-id=\"14\">The </g><strong><code>compile</code></strong><g class=\"gr_ gr_14 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"14\" data-gr-id=\"14\"> command</g> compiles Sophia contract. It&#8217;s recommended to <g class=\"gr_ gr_31 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"31\" data-gr-id=\"31\">use </g><strong><code>.aes</code></strong><g class=\"gr_ gr_31 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"31\" data-gr-id=\"31\"> <g class=\"gr_ gr_30 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Grammar only-ins replaceWithoutSep\" id=\"30\" data-gr-id=\"30\">file</g></g> extension. <g class=\"gr_ gr_52 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Grammar only-ins replaceWithoutSep\" id=\"52\" data-gr-id=\"52\">Default</g> directory <g class=\"gr_ gr_60 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"60\" data-gr-id=\"60\">is </g><code>$projectDir/contracts</code><g class=\"gr_ gr_60 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"60\" data-gr-id=\"60\">.</g> The result of the compilation is the contract bytecode printed in the console. <g class=\"gr_ gr_44 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Grammar only-ins doubleReplace replaceWithoutSep\" id=\"44\" data-gr-id=\"44\">Additional</g> <strong><code>--path</code></strong> parameter is available, which can specify the path to the contract to be compiled.</p></blockquote>\n\n\n\n<h2>Writing Unit Tests<br></h2>\n\n\n\n<p class=\"has-text-align-left\">First, we need to edit our deployment script, so it knows which contracts should be using. We only replace <g class=\"gr_ gr_170 gr-alert gr_gramm gr_inline_cards gr_run_anim Style multiReplace\" id=\"170\" data-gr-id=\"170\"><g class=\"gr_ gr_104 gr-alert gr_spell gr_inline_cards gr_disable_anim_appear ContextualSpelling ins-del\" id=\"104\" data-gr-id=\"104\">the</g> </g><code>ExampleContract</code><g class=\"gr_ gr_170 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"170\" data-gr-id=\"170\"> with</g> our <g class=\"gr_ gr_171 gr-alert gr_gramm gr_inline_cards gr_run_anim Style multiReplace\" id=\"171\" data-gr-id=\"171\">own </g><code>AddressBook</code><g class=\"gr_ gr_171 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"171\" data-gr-id=\"171\"> </g><g class=\"gr_ gr_172 gr-alert gr_gramm gr_inline_cards gr_run_anim Style multiReplace\" id=\"172\" data-gr-id=\"172\"><g class=\"gr_ gr_171 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"171\" data-gr-id=\"171\">in</g> </g><code>./deployments/deploy.js</code><g class=\"gr_ gr_172 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"172\" data-gr-id=\"172\">.</g> It should now look like this:</p>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/6040c299a84fea0c81217e8721d11fd8.js\"></script><figcaption>AddressBook.aes deployment script</figcaption></figure>\n\n\n\n<p style=\"text-align:left\"><strike>You probably have noticed that we pass the <code>address</code> as <code>0xe9bbf604e611b5460a3b3999e9771b6f60417d73ce7c5519e12f7e127a1225ca</code> instead of aeternity&#8217;s <code>ak_2mwRmUeYmfuW93ti9HMSUJzCk1EYcQEfikVSzgo6k2VghsWhgU</code>. That is because sophia is using the bytes hex representation of our base58 encoded address. We can use <code>aecli</code> to decode our address and prepend <code>0x</code> afterwards :</strike></p>\n\n\n\n<pre class=\"wp-block-preformatted\"><strike><code>aecli crypto decode ak_2mwRmUeYmfuW93ti9HMSUJzCk1EYcQEfikVSzgo6k2VghsWhgU</code></strike></pre>\n\n\n\n<p class=\"has-text-align-left\"><s>We should receive this output:</s></p>\n\n\n\n<blockquote class=\"wp-block-quote has-text-align-left\"><p><strike>Decoded address (hex): e9bbf604e611b5460a3b3999e9771b6f60417d73ce7c5519e12f7e127a1225ca</strike></p></blockquote>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"809\" height=\"349\" src=\"https://hack.bg/wp-content/uploads/2019/01/aecli-crypto-decode.png\" alt=\"aecli crypto decode aeternity address\" class=\"wp-image-493\" srcset=\"https://hack.bg/wp-content/uploads/2019/01/aecli-crypto-decode.png 809w, https://hack.bg/wp-content/uploads/2019/01/aecli-crypto-decode-300x129.png 300w, https://hack.bg/wp-content/uploads/2019/01/aecli-crypto-decode-768x331.png 768w\" sizes=\"(max-width: 809px) 100vw, 809px\" /><figcaption>aecli crypto decode aeternity address</figcaption></figure></div>\n\n\n\n<p class=\"has-text-align-left\">Writing unit test for aeternity sophia smart contract is similar to writing unit tests for Ethereum solidity smart contract.</p>\n\n\n\n<p class=\"has-text-align-left\"><strike>The interesting and thing is passing arguments to functions. As you can see, we are now passing <g class=\"gr_ gr_12 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Grammar only-del replaceWithoutSep\" id=\"12\" data-gr-id=\"12\">the our</g> args<code>address</code><g class=\"gr_ gr_17 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Punctuation only-del replaceWithoutSep\" id=\"17\" data-gr-id=\"17\">,</g><code>first_name</code><g class=\"gr_ gr_17 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Punctuation only-del replaceWithoutSep\" id=\"17\" data-gr-id=\"17\">,</g><code>last_name</code><g class=\"gr_ gr_17 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Punctuation only-del replaceWithoutSep\" id=\"17\" data-gr-id=\"17\">,</g> <g class=\"gr_ gr_25 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"25\" data-gr-id=\"25\">and </g><code>age</code><g class=\"gr_ gr_25 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"25\" data-gr-id=\"25\"> as</g> tuple string.</strike></p>\n\n\n\n<pre class=\"wp-block-preformatted\"><strike>      args: `(${address}, \"${first_name}\", \"${last_name}\", ${age})`,</strike></pre>\n\n\n\n<p class=\"note\"><em>Note</em>: If you are passing <g class=\"gr_ gr_13 gr-alert gr_gramm gr_inline_cards gr_run_anim Grammar only-ins doubleReplace replaceWithoutSep\" id=\"13\" data-gr-id=\"13\">string</g>, do not forget to add quotes (<code>\"</code>) around the string too (<code>(\"Some string\")</code>). More than one parameter can be passed separated by coma (<code>(\"Some string\", 123, 45, \"Other string\")</code>))deploy</p>\n\n\n\n<p class=\"has-text-align-left\"><strike>Another quite handy thing is that the function call result comes with <g class=\"gr_ gr_5 gr-alert gr_spell gr_inline_cards gr_disable_anim_appear ContextualSpelling ins-del multiReplace\" id=\"5\" data-gr-id=\"5\">built </g><g class=\"gr_ gr_91 gr-alert gr_gramm gr_inline_cards gr_run_anim Style multiReplace\" id=\"91\" data-gr-id=\"91\"><g class=\"gr_ gr_5 gr-alert gr_spell gr_inline_cards gr_disable_anim_appear ContextualSpelling ins-del multiReplace\" id=\"5\" data-gr-id=\"5\">in</g> </g><code>decode()</code><g class=\"gr_ gr_91 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"91\" data-gr-id=\"91\"> function</g>, which you can use for decoding the function output by passing the type you want to decode it to e.g. primitives like <code>int</code> , <code>string</code> <g class=\"gr_ gr_93 gr-alert gr_gramm gr_inline_cards gr_run_anim Style multiReplace\" id=\"93\" data-gr-id=\"93\">or </g><code>bool</code><g class=\"gr_ gr_93 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"93\" data-gr-id=\"93\">.</g> This is quite important for our unit tests so we know how we are going to <code>assert</code> the results.</strike></p>\n\n\n\n<pre class=\"wp-block-preformatted\"><s>    const addPersonResult = await addPerson.decode('bool');</s></pre>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/2d679aadd9cabc1ac296399354c87562.js\"></script><figcaption>AddressBook aepp unit tests</figcaption></figure>\n\n\n\n<p class=\"has-text-align-left\">Now if we run <code>aeproject test</code> we should see our unit tests output:</p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>aeproject test</code></pre>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"837\" height=\"587\" src=\"https://hack.bg/wp-content/uploads/2019/01/forgae-test-sophia-unit-tests.png\" alt=\"forgae test output - addressbook aepp\" class=\"wp-image-491\" srcset=\"https://hack.bg/wp-content/uploads/2019/01/forgae-test-sophia-unit-tests.png 837w, https://hack.bg/wp-content/uploads/2019/01/forgae-test-sophia-unit-tests-300x210.png 300w, https://hack.bg/wp-content/uploads/2019/01/forgae-test-sophia-unit-tests-768x539.png 768w, https://hack.bg/wp-content/uploads/2019/01/forgae-test-sophia-unit-tests-821x576.png 821w\" sizes=\"(max-width: 837px) 100vw, 837px\" /><figcaption>forgae test output &#8211; addressbook aepp</figcaption></figure></div>\n\n\n\n<h2>Conclusion</h2>\n\n\n\n<p class=\"has-text-align-left\">Writing smart contracts on Sophia is very intuitive if you have previous experience writing smart contracts or experience with programming languages like Python.<br></p>\n\n\n\n<p class=\"has-text-align-left\">We will continue this series with some more sophisticated examples which will include deployment on testnet and mainnet and more soon. If you don&#8217;t want to miss the new content &#8211; join our <a href=\"http://eepurl.com/gcxyRj\">newsletter</a> to receive all our new content.</p>\n\n\n\n<h3>Useful links</h3>\n\n\n\n<ul><li><a href=\"https://meetup.com/blockchain-developers-meetup-bulgaria\">Blockchain Developers Meetup</a></li><li><a href=\"https://facebook.com/BlockchainDevelopersMeetup\">FacebookGroup</a></li><li><a href=\"http://linkedin.com/company/hack-blockchain-development/\">LinkedIn</a></li><li><a href=\"https://twitter.com/hack_bg\">Twitter</a></li></ul>\n\n\n\n<h4>Resources</h4>\n\n\n\n<ul><li><a href=\"http://github.com/mradkov/addressbook-aepp-aeternity\">AddressBook <g class=\"gr_ gr_6 gr-alert gr_spell gr_inline_cards gr_disable_anim_appear ContextualSpelling ins-del multiReplace\" id=\"6\" data-gr-id=\"6\">aepp</g> &#8211; Github Repo of the project</a></li><li><a href=\"https://github.com/aeternity/protocol\">Aeternity protocol <g class=\"gr_ gr_7 gr-alert gr_spell gr_inline_cards gr_disable_anim_appear ContextualSpelling ins-del multiReplace\" id=\"7\" data-gr-id=\"7\">github</g></a></li><li><a href=\"http://forum.aeternity.com/\">Aeternity forum</a></li></ul>\n","excerpt":"<p>Æternity blockchain is live after long period of waiting, the community is big and the core developers are top skilled. The project offers smart contracts development platform for decentralized applications dapps or how they call them &#8211; æpps. In this tutorial we are going to create a simple smart contract in Sophia ML programming language [&hellip;]</p>\n","categories":[{"id":"4","title":"Tutorials","path":"/category/tutorials/"}],"author":{"name":"Milen Radkov","path":"/author/milen/"}}},{"node":{"date":"2018-12-29T09:30:09","id":"286","title":"[Part two &#8211; Unit Testing] Build a Decentralized Domain Name System (DDNS) on top of Ethereum","path":"/blog/part-two-unit-testing-build-a-decentralized-domain-name-system-ddns-on-top-of-ethereum/","content":"\n<p class=\"has-drop-cap\">Whether you develop software yourself or <a href=\"https://hack.bg/#contact\">hire developers</a> to build it for you, you expect them to do everything necessary, so you can get functional and bug-free software. Sometimes, however, doing the right thing takes additional time, which is often being skipped due to all the deadlines, budget or some other reason.</p>\n\n\n\n<p>In blockchain development as in the traditional software development, unit testing reduces the number of bugs, making it &#8220;a must&#8221; to effective software development. </p>\n\n\n\n<p>In this article, we are going to look at this type of testing &#8211; unit testing &#8211; and why you should not cut corners and skip this part of the software development cycle.</p>\n\n\n\n<hr class=\"wp-block-separator\"/>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"1024\" height=\"683\" src=\"https://hack.bg/wp-content/uploads/2018/12/unit-testing-decentralized-domain-name-system-hack-1024x683.jpg\" alt=\"Unit Testing Decentralized Domain Name System\" class=\"wp-image-386\" srcset=\"https://hack.bg/wp-content/uploads/2018/12/unit-testing-decentralized-domain-name-system-hack-1024x683.jpg 1024w, https://hack.bg/wp-content/uploads/2018/12/unit-testing-decentralized-domain-name-system-hack-300x200.jpg 300w, https://hack.bg/wp-content/uploads/2018/12/unit-testing-decentralized-domain-name-system-hack-768x512.jpg 768w, https://hack.bg/wp-content/uploads/2018/12/unit-testing-decentralized-domain-name-system-hack-864x576.jpg 864w, https://hack.bg/wp-content/uploads/2018/12/unit-testing-decentralized-domain-name-system-hack.jpg 1200w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /><figcaption>Unit Testing Decentralized Domain Name System</figcaption></figure></div>\n\n\n\n<hr class=\"wp-block-separator\"/>\n\n\n\n<p>This is part two of our series of building decentralized domain name system on top of <a href=\"https://ethereum.org/\">Ethereum</a>, where we&#8217;ll get familiar with good practices and techniques during <g class=\"gr_ gr_34 gr-alert gr_gramm gr_inline_cards gr_run_anim Grammar only-ins replaceWithoutSep\" id=\"34\" data-gr-id=\"34\">unit</g> testing process and deployment of a decentralized application (<g class=\"gr_ gr_14 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del multiReplace\" id=\"14\" data-gr-id=\"14\">dApp</g>) development lifecycle.</p>\n\n\n\n<p>In the first part, we developed a decentralized application consisted of Ethereum smart contracts, that are acting as a decentralized domain name system. So, at this point, a user should be able to buy, renew, edit and transfer a domain name according to our <g class=\"gr_ gr_191 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del multiReplace\" id=\"191\" data-gr-id=\"191\">dApp&#8217;s</g> logic. If you haven&#8217;t checked out <a href=\"https://hack.bg/blog/tutorials/part-one-smart-contracts-build-a-decentralized-domain-name-system-ddns-on-top-of-ethereum/\">the first part of our tutorial</a> yet &#8211; this is probably the time to do so.</p>\n\n\n\n<p>To sum up:</p>\n\n\n\n<ul><li>Unit tests are code that tests your contract code</li><li>It executes your contract with predefined function calls (test cases)</li><li>It compares the result of the execution with the expected result for this case</li></ul>\n\n\n\n<h2>Tooling</h2>\n\n\n\n<p>The most popular and commonly used way of creating unit tests for Ethereum smart contracts written in Solidity is by using the following tool-set.</p>\n\n\n\n<ol><li><a href=\"https://truffleframework.com/truffle\">Truffle</a> &#8211; is the most popular development framework for Ethereum. <ul><li>Built-in smart contract compilation, linking, deployment and binary management.</li><li>Automated contract testing for rapid development.</li><li>Scriptable, extensible deployment &amp; migrations framework.</li><li>Network management for deploying to any number of public &amp; private networks.</li><li>Package management with EthPM &amp; NPM, using the <a href=\"https://github.com/ethereum/EIPs/issues/190\">ERC190</a> standard.</li><li>Interactive console for direct contract communication.</li><li>Configurable build pipeline with support for tight integration.</li><li>External script runner that executes scripts within a Truffle environment. </li></ul></li><li><a href=\"https://truffleframework.com/ganache\">Ganache</a> &#8211; lets you quickly fire up a personal Ethereum blockchain which you can use to run tests, execute commands, and inspect state while controlling how the chain operates.</li></ol>\n\n\n\n<hr class=\"wp-block-separator\"/>\n\n\n\n<p>Without further due, let&#8217;s jump into setting up our project and environment for unit testing.<br></p>\n\n\n\n<p>First if we haven&#8217;t already, we need to install Truffle globally (-g)</p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>npm install -g truffle</code></pre>\n\n\n\n<p>and Ganache &#8211; It is available as both a desktop application as well as a command-line tool (formerly known as the TestRPC). For the purpose of our tutorial we are going to use the command-line tool.</p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>npm install -g ganache-cli</code></pre>\n\n\n\n<p><g class=\"gr_ gr_5 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del\" id=\"5\" data-gr-id=\"5\">Okey</g>, now we are good to go. There is a tutorial for using truffle for <g class=\"gr_ gr_37 gr-alert gr_gramm gr_inline_cards gr_run_anim Grammar only-ins doubleReplace replaceWithoutSep\" id=\"37\" data-gr-id=\"37\">unit</g> testing in their website <a href=\"https://truffleframework.com/tutorials/testing-for-throws-in-solidity-tests\">here</a>, but <g class=\"gr_ gr_18 gr-alert gr_gramm gr_inline_cards gr_run_anim Grammar only-ins replaceWithoutSep\" id=\"18\" data-gr-id=\"18\"><code>throw</code></g> function used there is now deprecated and replaced by <code>revert()</code>, <code>require()</code> and <code>assert()</code>. So it will be somewhat helpful if you know how the last work.</p>\n\n\n\n<p>Nevertheless, let us verify our knowledge by a quick lookup at the <a href=\"https://solidity.readthedocs.io/en/develop/control-structures.html#error-handling-assert-require-revert-and-exceptions\">Solidity documentation</a>:</p>\n\n\n\n<blockquote class=\"wp-block-quote\"><p>Error handling: Assert, Require, Revert and Exceptions<br> Solidity uses state-reverting exceptions to handle errors. Such an exception will undo all changes made to the state in the current call (and all its sub-calls) and also flag an error to the caller. The convenience functions <code>assert</code> and <code>require</code> can be used to check for conditions and throw an exception if the condition is not met. The <code>assert</code> function should only be used to test for internal errors, and to check invariants. The <code>require</code>  function should be used to ensure valid conditions, such as inputs, or  contract state variables are met, or to validate return values from  calls to external contracts. If used properly, analysis tools can evaluate your contract to identify  the conditions and function calls which will reach a failing <code>assert</code>.  Properly functioning code should never reach a failing assert  statement; if this happens there is a bug in your contract which you  should fix.<br> There are two other ways to trigger exceptions: The <code>revert</code> function can be used to flag an error and revert the current call. It is possible to provide a string message containing details about the error that will be passed back to the caller.</p><cite>Solidity documentation</cite></blockquote>\n\n\n\n<h2>Project initialization</h2>\n\n\n\n<p class=\"note\"><strong>Note:</strong> If you have initialized your project with <code>truffle init</code> you can skip this part.</p>\n\n\n\n<p>In the first part we covered mainly the code, but not the environment, IDE and project setup, but for our tests to run properly we will need that set.</p>\n\n\n\n<p>Setting up a new truffle project:</p>\n\n\n\n<pre class=\"wp-block-preformatted\"><code>truffle init</code></pre>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"682\" height=\"564\" src=\"https://hack.bg/wp-content/uploads/2018/12/decentralized-dns-truffle-init.png\" alt=\"Decentralized Domain Name System - project initialization\" class=\"wp-image-345\" srcset=\"https://hack.bg/wp-content/uploads/2018/12/decentralized-dns-truffle-init.png 682w, https://hack.bg/wp-content/uploads/2018/12/decentralized-dns-truffle-init-300x248.png 300w\" sizes=\"(max-width: 682px) 100vw, 682px\" /><figcaption>Decentralized Domain Name System &#8211; project initialization</figcaption></figure></div>\n\n\n\n<p>As you notice after project initialization Truffe adds some files into our project directory: </p>\n\n\n\n<ul><li><code>./contracts</code> &#8211; directory where our smart contracts should be stored.</li><li><code>./migrations</code> &#8211; directory for placing our migrations scripts.</li><li><code>./test</code> &#8211; directory for test files for testing our decentralized application.</li><li><code>./truffle-config.js</code> &#8211; this is our project&#8217;s truffle configuration file.</li></ul>\n\n\n\n<h2>Writing Unit Tests</h2>\n\n\n\n<p>Writing unit tests is a must for decentralized applications development life-cycle, so we can be sure the application works <strong>the way it is designed to</strong>.</p>\n\n\n\n<p>So Truffle gives us couple of possible options to write tests &#8211; in JavaScript, TypeScript (testing your contract via web3) or Solidity (testing your contract from another contract). In our tutorial we will cover unit testing with JavaScript which its the most adopted way of doing so in my opinion.</p>\n\n\n\n<p>All contracts in truffle&#8217;s contracts folder are accessible and are published automatically for our tests. Our unit tests should be placed in the <code>./test</code> folder and must end with <code>.js</code> extension so it can be recognized as an automated test by <a href=\"https://mochajs.org/\">Mocha</a> framework which Truffle uses for testing. For the assertions Truffle uses <a href=\"https://www.chaijs.com/\">Chai</a>, which you may or may not be familiar with.</p>\n\n\n\n<blockquote class=\"wp-block-quote is-style-default\"><p>Chai is a BDD / TDD assertion library for <a href=\"http://nodejs.org\">node</a> and can be paired with any javascript testing framework.</p><cite>Chaijs</cite></blockquote>\n\n\n\n<p>Truffle&#8217;s got well structured, extensive <a href=\"https://truffleframework.com/docs/truffle/overview\">documentation</a> which you can read upon and get familiar with, if you want to.</p>\n\n\n\n<hr class=\"wp-block-separator\"/>\n\n\n\n<figure class=\"wp-block-pullquote is-style-default\"><blockquote><p>So starting with the structure of a unit test case.</p></blockquote></figure>\n\n\n\n<p>A test is a call of a contract function with predefined (hard-coded) arguments and a predefined expected output. And the expected output should be the correct way the contract functions.</p>\n\n\n\n<blockquote class=\"wp-block-quote\"><p>What makes Truffle tests different from that of Mocha is the <code>contract()</code> function: This function works exactly like <code>describe()</code> except it enables Truffle&#8217;s <a href=\"https://truffleframework.com/docs/truffle/testing/testing-your-contracts#clean-room-environment\">clean-room features</a>.</p><cite>Truffle documentation</cite></blockquote>\n\n\n\n<p>Each group of tests is ran with clean contract state, meaning that for every test new contract is being published.</p>\n\n\n\n<p>Here is how our DDNSService.test.js should look like:</p>\n\n\n\n<pre><code>\n\nconst DDNSService = artifacts.require('../contracts/DDNSService.sol')\n\n// place helpers here\n\ncontract('DDNSService', ([owner, wallet, anotherAccount]) =&gt; {\n\tlet contractInstance;\n\tlet events = [];\n\n\tbefore(() =&gt; {\n\t\tweb3.eth.defaultAccount = owner;\n\t});\n\n\tbeforeEach(async () =&gt; {\n\t\tcontractInstance = await DDNSService.new();\n\t});\n\n\tafterEach(() =&gt; {\n\t\tif (events.length) {\n\t\t\tevents.forEach((ev) =&gt; {\n\t\t\t\tev.stopWatching();\n\t\t\t});\n\n\t\t\tevents = [];\n\t\t}\n    });\n  \n    it(\"BYTES_DEFAULT_VALUE constant Should have exact value\", async () =&gt; {\n\t\t// Arrange\n\n\t\t// Act\n\t\tconst result = await contractInstance.BYTES_DEFAULT_VALUE();\n\n\t\t// Assert\n\t\tassert.equal(result, '0x00');\n   });\n\n... more tests \n\n});</code></pre>\n\n\n\n<p><br></p>\n\n\n\n<p>In the code above, we&#8217;ve set our contract instance and written the first test, which tests whether the <code>BYTES_DEFAULT_VALUE</code> constant in our smart contract is set to <code>0x00</code>.</p>\n\n\n\n<p>Here is a more sophisticated example &#8211; <i>register Should throw when the sent funds are insufficient</i> &#8211; we are getting the price for the passed domain name, IP, TLD, substract 1 via <code>.minus(1)</code> so we can have a smaller than the actual domain price saved in our <code>currentPrice</code> constant, which we pass as value argument for the domain register via the <code>register()</code> function afterwards. Then we assert whether the call failed with <code>assertRevert</code>.</p>\n\n\n\n<pre><code>it(\"register Should throw when the sent funds are insufficient\", async () =&gt; {\n\t\t// Arrange\n\t\tconst domainName = \"milenradkov\";\n\t\tconst ip = \"127.0.0.1\";\n\t\tconst topLevelDomain = \"com\";\n\t\tconst currentPrice = (await contractInstance.getPrice(domainName)).minus(1);\n\t\t// Act\n\t\tconst result = contractInstance.register(domainName, topLevelDomain, ip, { from: anotherAccount, value: currentPrice });\n\t\t// Assert\n\t\tawait assertRevert(result);\n});</code></pre>\n\n\n\n<p>Unit tests in truffle can be written <g class=\"gr_ gr_4 gr-alert gr_gramm gr_inline_cards gr_run_anim Style multiReplace\" id=\"4\" data-gr-id=\"4\">using </g><code>.then</code><g class=\"gr_ gr_4 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"4\" data-gr-id=\"4\"> </g><g class=\"gr_ gr_5 gr-alert gr_gramm gr_inline_cards gr_run_anim Style multiReplace\" id=\"5\" data-gr-id=\"5\"><g class=\"gr_ gr_4 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"4\" data-gr-id=\"4\">or</g> </g><code>await/async</code><g class=\"gr_ gr_5 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Style multiReplace\" id=\"5\" data-gr-id=\"5\"> style</g>, so it&#8217;s up to the developer&#8217;s preference how to write them.</p>\n\n\n\n<hr class=\"wp-block-separator\"/>\n\n\n\n<p>Testing the contract against the cases we&#8217;ve coded is really simple:</p>\n\n\n\n<p>1. Start <code>ganache-cli</code> in separate terminal/cmd &#8211; this will instantiate our private blockchain which we are going to use for tests.</p>\n\n\n\n<pre><code>ganache-cli</code></pre>\n\n\n\n<p>2. Run <code>truffle test</code> command from the project directory.</p>\n\n\n\n<pre><code>truffle test</code></pre>\n\n\n\n<hr class=\"wp-block-separator\"/>\n\n\n\n<p>As you&#8217;ve probably noticed already, we are using the so known AAA (<a href=\"http://wiki.c2.com/?ArrangeActAssert\">Arrange Act Assert</a>) pattern for our unit tests &#8211; it&#8217;s always good to stick to well-formatted code and best practices when you are coding for lots of well-known reasons.</p>\n\n\n\n<blockquote class=\"wp-block-quote\"><p>&#8220;Arrange-Act-Assert&#8221;a pattern for arranging and formatting code in <a href=\"http://wiki.c2.com/?UnitTest\">UnitTest</a> methods: </p><p>Each method should group these functional sections, separated by blank lines: </p><ol><li> <strong>Arrange</strong> all necessary preconditions and inputs.\n</li><li> <strong>Act</strong> on the object or method under test.\n</li><li> <strong>Assert</strong> that the expected results have occurred.\n</li></ol><cite>Arrange-Act-Assert pattern unit test</cite></blockquote>\n\n\n\n<h3>Helpers</h3>\n\n\n\n<p>We are going to need some predefined helpers for some of our next test cases, which names are speaking for what they actually do respectively.</p>\n\n\n\n<pre><code>\n//helpers\nconst assertRevert = require('./utils/assertRevert');\nconst watchEvent = require('./utils/watchEvent');\nconst constants = require('./utils/constants');\nconst increaseTime = require('./utils/increaseTime');</code></pre>\n\n\n\n<h3>Coverage</h3>\n\n\n\n<p>Following this logic here are all the test cases covering most of the edge cases of our decentralized domain name service smart contract functions.</p>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/2470c611a7a3d0be1508ead681929a90.js\"></script><figcaption></figcaption></figure>\n\n\n\n<hr class=\"wp-block-separator\"/>\n\n\n\n<h2>Running tests</h2>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"799\" height=\"537\" src=\"https://hack.bg/wp-content/uploads/2018/12/ganache_cli.png\" alt=\"instantiate ganache-cli\" class=\"wp-image-376\" srcset=\"https://hack.bg/wp-content/uploads/2018/12/ganache_cli.png 799w, https://hack.bg/wp-content/uploads/2018/12/ganache_cli-300x202.png 300w, https://hack.bg/wp-content/uploads/2018/12/ganache_cli-768x516.png 768w\" sizes=\"(max-width: 799px) 100vw, 799px\" /><figcaption>instantiate ganache-cli</figcaption></figure></div>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"799\" height=\"537\" src=\"https://hack.bg/wp-content/uploads/2018/12/ganache_cli_running.png\" alt=\"ganache-cli running\" class=\"wp-image-377\" srcset=\"https://hack.bg/wp-content/uploads/2018/12/ganache_cli_running.png 799w, https://hack.bg/wp-content/uploads/2018/12/ganache_cli_running-300x202.png 300w, https://hack.bg/wp-content/uploads/2018/12/ganache_cli_running-768x516.png 768w\" sizes=\"(max-width: 799px) 100vw, 799px\" /><figcaption>ganache-cli running</figcaption></figure></div>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"843\" height=\"604\" src=\"https://hack.bg/wp-content/uploads/2018/12/truffle_test.png\" alt=\"truffle test - Decentralized Domain Name System using Solidity Smart Contracts on top of Ethereum\" class=\"wp-image-378\" srcset=\"https://hack.bg/wp-content/uploads/2018/12/truffle_test.png 843w, https://hack.bg/wp-content/uploads/2018/12/truffle_test-300x215.png 300w, https://hack.bg/wp-content/uploads/2018/12/truffle_test-768x550.png 768w, https://hack.bg/wp-content/uploads/2018/12/truffle_test-804x576.png 804w\" sizes=\"(max-width: 843px) 100vw, 843px\" /><figcaption>truffle test &#8211; Decentralized Domain Name System using Solidity Smart Contracts on top of Ethereum</figcaption></figure></div>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"843\" height=\"604\" src=\"https://hack.bg/wp-content/uploads/2018/12/truffle_test_passing.png\" alt=\"Truffle Test passing - Decentralized Domain Name System using Solidity Smart Contracts on top of Ethereum\" class=\"wp-image-379\" srcset=\"https://hack.bg/wp-content/uploads/2018/12/truffle_test_passing.png 843w, https://hack.bg/wp-content/uploads/2018/12/truffle_test_passing-300x215.png 300w, https://hack.bg/wp-content/uploads/2018/12/truffle_test_passing-768x550.png 768w, https://hack.bg/wp-content/uploads/2018/12/truffle_test_passing-804x576.png 804w\" sizes=\"(max-width: 843px) 100vw, 843px\" /><figcaption>Truffle Test passing &#8211; Decentralized Domain Name System using Solidity Smart Contracts on top of Ethereum</figcaption></figure></div>\n\n\n\n<h2>Conclusion</h2>\n\n\n\n<p>Unit testing are important when developing smart contracts on Ethereum, as there are lots of vulnerabilities or edge cases that can lead to security flaws or value (ETH) theft.</p>\n\n\n\n<p>In the next few parts we will set up code coverage and continuous integration with Travis CI. </p>\n\n\n\n<p>Also we will look deeper in to the security part of development and testing, tips and tricks and more, so <a href=\"http://eepurl.com/gcxyRj\">stay tuned.</a></p>\n\n\n\n<h3><strong>Useful links</strong></h3>\n\n\n\n<ul><li><a href=\"https://hack.bg/blog/tutorials/part-one-smart-contracts-build-a-decentralized-domain-name-system-ddns-on-top-of-ethereum/\">Part one &#8211; Smart Contracts &#8211; Build Decentralized Domain Name System on top of Ethereum</a></li><li>Part two &#8211; Unit Testing &#8211; [you are here] 🙂</li><li>Part three &#8211; Coming soon &#8230;</li></ul>\n\n\n\n<p><strong> Website</strong>: <a rel=\"noreferrer noopener\" href=\"https://hack.bg\" target=\"_blank\">https://hack.bg</a></p>\n\n\n\n<p><strong>Follow us on social media:</strong></p>\n\n\n\n<ul><li><a rel=\"noreferrer noopener\" href=\"https://twitter.com/hack_bg\" target=\"_blank\">Twitter</a></li><li><a rel=\"noreferrer noopener\" href=\"https://facebook.com/hackbg\" target=\"_blank\">Facebook</a></li><li><a rel=\"noreferrer noopener\" href=\"https://www.linkedin.com/company/hackbg-blockchain-web-software-solutions/\" target=\"_blank\">LinkedIn</a></li><li><a href=\"https://meetup.com/blockchain-developers-meetup-bulgaria\">Blockchain Developers Meetup</a></li></ul>\n","excerpt":"<p>Whether you develop software yourself or hire developers to build it for you, you expect them to do everything necessary, so you can get functional and bug-free software. Sometimes, however, doing the right thing takes additional time, which is often being skipped due to all the deadlines, budget or some other reason. In blockchain development [&hellip;]</p>\n","categories":[{"id":"4","title":"Tutorials","path":"/category/tutorials/"}],"author":{"name":"Milen Radkov","path":"/author/milen/"}}},{"node":{"date":"2018-11-30T10:46:53","id":"107","title":"[Part one &#8211; Smart Contracts] Build a Decentralized Domain Name System (DDNS) on top of Ethereum","path":"/blog/part-one-smart-contracts-build-a-decentralized-domain-name-system-ddns-on-top-of-ethereum/","content":"\n<h3>Intro</h3>\n\n\n\n<p>Nowadays it is quite popular to <a href=\"https://hack.bg\" rel=\"noreferrer noopener\" target=\"_blank\"><strong>build</strong> <strong>a</strong> <strong>decentralized application</strong></a><strong> (dApp)</strong>. If you are familiar with the blockchain smart contracts development and you’ve already developed something cool, probably there is no need for me to tell you that in this field the demand for good developers is quite high.</p>\n\n\n\n<p>But for you to be a good smart contracts developer, you have to research, learn the best coding practices, educate yourself and practice coding constantly.</p>\n\n\n\n<p>In this tutorial, I’m going to show you step by step my implementation on how to create a <strong>decentralized</strong> <strong>application</strong> which functions as a simplified <strong>DNS</strong> (<strong>domain name system</strong>). It was created a while back, but recently got a lot of attention, so I decided to make a short tutorial explaining the steps in the making.</p>\n\n\n\n<hr class=\"wp-block-separator\"/>\n\n\n\n<p>There are quite a lot of blockchain platforms that give us the opportunity to develop smart contracts and decentralized applications on top of their networks and infrastructure. The main platforms used for dApp development are <a href=\"https://aeternity.com/\" rel=\"noreferrer noopener\" target=\"_blank\">Aeternity</a>, <a href=\"http://ethereum.org\" rel=\"noreferrer noopener\" target=\"_blank\">Ethereum</a>, <a href=\"https://neo.org/\" rel=\"noreferrer noopener\" target=\"_blank\">NEO</a>, <a href=\"https://eos.io/\" rel=\"noreferrer noopener\" target=\"_blank\">EOS</a>, <a href=\"https://qtum.org/\" rel=\"noreferrer noopener\" target=\"_blank\">QTUM</a>, <a href=\"https://www.cardano.org\" rel=\"noreferrer noopener\" target=\"_blank\">Cardano</a>, <a href=\"https://stratisplatform.com\" rel=\"noreferrer noopener\" target=\"_blank\">Stratis</a> and for sure we will see a lot more in the nearest future. But for the purpose of this tutorial, we’ll be using <a href=\"http://solidity.readthedocs.io\" rel=\"noreferrer noopener\" target=\"_blank\">Solidity</a> as our development language and Ethereum’s infrastructure, as Ethereum is the most widely used for dApps development <strong>for now.</strong></p>\n\n\n\n<hr class=\"wp-block-separator\"/>\n\n\n\n<p>If you do not know what a domain name system is, and how it works, now is the time for you to go to Wikipedia and check <a href=\"https://en.wikipedia.org/wiki/Domain_Name_System\" rel=\"noreferrer noopener\" target=\"_blank\">DNS</a> out to get a basic understanding of it.</p>\n\n\n\n<blockquote class=\"wp-block-quote\"><p>At first building a decentralized DNS on top of Ethereum might seem like a trivial task, but we will make it a bit more complex&nbsp;… right&nbsp;now</p></blockquote>\n\n\n\n<p>Let us set some requirements for our project — simplified decentralized domain name system (DDNS).</p>\n\n\n\n<hr class=\"wp-block-separator\"/>\n\n\n\n<h3>Requirements</h3>\n\n\n\n<ol><li>We should be able to <strong>register a domain</strong> by providing the domain name and an IP address it should point to. There are also some other conditions:</li></ol>\n\n\n\n<ul><li>A registered domain cannot be bought and is owned by the caller of the method.</li><li>The domain registration should cost 1 ETH and the domain should be registered for 1 year.</li><li>After 1 year, anyone is allowed to buy the domain again.</li><li>The domain registration can be extended by 1 year if the domain owner calls the register method and pays 1 ETH.</li><li>The domain can be any string with length <strong>more than 5 symbols.</strong></li></ul>\n\n\n\n<p>2. We need a public method to edit a domain. In our simplified <strong>decentralized DNS </strong>system, the editing of a domain will be changing the IP address it points to. The operation should be free and only the owner of the domain should be able to edit the domain.</p>\n\n\n\n<p>3. Public method to transfer the domain ownership to another user. Again this operation is free and only the domain owner can transfer his domains ownership to somebody else.</p>\n\n\n\n<p>4. Public method to get the IP based on a given domain.</p>\n\n\n\n<p>5. A Public method that returns a list of all <strong>receipts</strong> by a certain account. A <strong>receipt</strong> is a domain purchase/extension and contains the price, timestamp of purchase and expiration date of the domain.</p>\n\n\n\n<p>And since this is a domain name system, we want to make it as similar to the current ones as possible, so we are going to add some more additional features like:</p>\n\n\n\n<ul><li>Dynamic pricing — the base price can increase if a short domain name is bought.</li><li>Public method to withdraw the funds from the contract. <strong>This should be called only from the contract owner </strong>(the address which initially created the contract).</li><li>Use <strong>contract events</strong> to signify that an activity has taken place in the contract. Events can be for domain registration/transfer (DDNS) etc.</li></ul>\n\n\n\n<p>And lastly, we need to have unit tests for everything we’ve done so far.</p>\n\n\n\n<hr class=\"wp-block-separator\"/>\n\n\n\n<h3>Implementation</h3>\n\n\n\n<h4>Step 1: Architecture design</h4>\n\n\n\n<p>First, we need to think about our architecture and design it. In our case it is a very simple project so the architecture could be something like this:</p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"1024\" height=\"576\" src=\"https://hack.bg/wp-content/uploads/2018/12/Decentralized-DNS-1024x576.png\" alt=\"\" class=\"wp-image-115\" srcset=\"https://hack.bg/wp-content/uploads/2018/12/Decentralized-DNS-1024x576.png 1024w, https://hack.bg/wp-content/uploads/2018/12/Decentralized-DNS-300x169.png 300w, https://hack.bg/wp-content/uploads/2018/12/Decentralized-DNS-768x432.png 768w, https://hack.bg/wp-content/uploads/2018/12/Decentralized-DNS-480x270.png 480w, https://hack.bg/wp-content/uploads/2018/12/Decentralized-DNS.png 1920w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /><figcaption>Figure 1 — Decentralized DNS (domain name system) Architecture</figcaption></figure></div>\n\n\n\n<h4>Step 2: Architecture preparation</h4>\n\n\n\n<p>There are already smart contracts for the safe math operations, ownership logic and destruction logic provided from <a href=\"https://github.com/OpenZeppelin/openzeppelin-solidity\" rel=\"noreferrer noopener\" target=\"_blank\">OpenZeppelin</a>, that have passed multiple security audits, so we don’t need to reinvent the wheel.</p>\n\n\n\n<p>For the math operations we are going to use <a href=\"https://github.com/OpenZeppelin/openzeppelin-solidity/blob/9b3710465583284b8c4c5d2245749246bb2e0094/contracts/math/SafeMath.sol\" rel=\"noreferrer noopener\" target=\"_blank\">SafeMath library</a>, which looks like this:</p>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/edc27fd2e860d274a1ed27eed9e1b2ef.js\"></script>\n<figcaption>SafeMath.sol — Safe Mathematical operations in Solidity</figcaption></figure>\n\n\n\n<p>For the ownership and destruction logic we will again use security audited and proven to work contracts from the <a href=\"https://github.com/OpenZeppelin/openzeppelin-solidity/\" rel=\"noreferrer noopener\" target=\"_blank\">openzeppelin-solidity Github</a> repository and then proceed with the implementation of our own DDNS.</p>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/df74ec982a3814e9b47eceb578bc17a9.js\"></script><figcaption>Ownable.sol — Ownership logic solidity</figcaption></figure>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/01aaa6104b7cf183d1fe969864080f2a.js\"></script><figcaption>Destructible.sol — Smart contract lifecycle logic solidity</figcaption></figure>\n\n\n\n<p>Lastly our main contract where we will put our logic for the <strong>decentralized domain name system </strong>(DDNS):</p>\n\n\n\n<p>It inherits the <strong>Destructible.sol</strong> contract which itself inherits the ownership logic from the <strong>Ownable.sol</strong> contract and we are good to go.</p>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/2ca5fb13bdd424d895ca7b25436c7faa.js\"></script><figcaption>DDNS initial contract</figcaption></figure>\n\n\n\n<p>The directory tree of our project could be looking like this at this point:</p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><img loading=\"lazy\" width=\"1024\" height=\"576\" src=\"https://hack.bg/wp-content/uploads/2018/12/DDNS-Directory-tree-1024x576.png\" alt=\"\" class=\"wp-image-116\" srcset=\"https://hack.bg/wp-content/uploads/2018/12/DDNS-Directory-tree-1024x576.png 1024w, https://hack.bg/wp-content/uploads/2018/12/DDNS-Directory-tree-300x169.png 300w, https://hack.bg/wp-content/uploads/2018/12/DDNS-Directory-tree-768x432.png 768w, https://hack.bg/wp-content/uploads/2018/12/DDNS-Directory-tree-480x270.png 480w, https://hack.bg/wp-content/uploads/2018/12/DDNS-Directory-tree.png 1920w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /><figcaption>Figure 2 — Project structure for <strong>Decentralized Domain Name&nbsp;System</strong></figcaption></figure></div>\n\n\n\n<h4>Step 3: Defining struct types, function modifiers, and state variables</h4>\n\n\n\n<p>Starting with the structures — <strong>structs</strong> are custom defined types that can group several variables. In our case, we will make some things easier by creating structures for them.</p>\n\n\n\n<p>So, as we all know every problem has lots of different approaches to be solved, and I challenge you to try solving this one yourself and not trust mine as the “one and only solution”.</p>\n\n\n\n<p><strong>Structs</strong></p>\n\n\n\n<p>We are defining the <strong>DomainDetails </strong>structure which has the following properties:</p>\n\n\n\n<ul><li><em>bytes</em> name — the domain name stored as bytes</li><li><em>bytes12</em> topLevel — the TLD of the domain</li><li><em>address</em> owner — address of the owner</li><li><em>bytes15</em> ip — IP that is related to the domain name</li><li><em>uint</em> expires — expiring date of the domain.</li></ul>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/df74ec982a3814e9b47eceb578bc17a9.js\"></script><figcaption>DomainDetails Structure for the DDNS implementation</figcaption></figure>\n\n\n\n<p>Second we are defining the <strong>Receipt </strong>structure — which is something we should provide the user according to the project requirements we’ve set in the beginning. It has the following properties&nbsp;:</p>\n\n\n\n<ul><li><em>uint</em> amountPaidWei — the price that was paid in this transaction, stored as the amount of wei (the smallest part of ether)</li><li><em>uint </em>timestamp — the time when this receipt was issued</li><li><em>uint</em> expires — expiring time</li></ul>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/e794c8461432ee45e93f0214e5251336.js\"></script><figcaption>Receipt structure for the DDNS implementation</figcaption></figure>\n\n\n\n<p><strong>Modifiers</strong></p>\n\n\n\n<blockquote class=\"wp-block-quote\"><p>Modifiers can be used to easily change the behavior of functions. For example, they can automatically check a condition prior to executing the function. Modifiers are inheritable properties of contracts and may be overridden by derived contracts.</p></blockquote>\n\n\n\n<p>First modifier that we are going to implement is an <strong>isAvailable </strong>modifier, which we will be using to check whether a certain domain name is available to be bought.</p>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/1b949804880dfe53deb43c9e7eb860f1.js\"></script><figcaption>isAvailable modifier &#8211; DDNS</figcaption></figure>\n\n\n\n<p>The next thing the <strong>collectDomainNamePayments </strong>modifier that we are going to use as the way for faster check if the user provided the right amount of money for the payment.</p>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/b9bb70959ea119cf895b00e3daf3c38c.js\"></script><figcaption>collectDomainNamePayment modifier for the DDNS implementation</figcaption></figure>\n\n\n\n<p>We need a modifier which we will use for checking whether the transaction initiator (msg.sender) is the owner of the certain domain — <strong>isDomainOwner</strong>.</p>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/f8f89b1ef1eb774e5c75603f8cce1f5a.js\"></script><figcaption>isDomainOwner modifier &#8211; DDNS</figcaption></figure>\n\n\n\n<p>And lastly, we need another two modifiers <strong>isDomainNameLengthAllowed </strong>and <strong>isTopLevelLengthAllowed </strong>for checking if the length of the provided domain name or TLD is allowed respectively.</p>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/333d5a7e530b2014e5cab5b3aaf1b492.js\"></script><figcaption>isDomainNameLengthAllowed modifier</figcaption></figure>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/0d06cf1e8c7224de694205ae25e51f4d.js\"></script><figcaption>isTopLevelLengthAllowed modifier</figcaption></figure>\n\n\n\n<p><strong>State variables and constants</strong></p>\n\n\n\n<p>We are going to add some constants which names speak for what they are actually used for:</p>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/a20d73ba8efabeb67abd6ea0743c448b.js\"></script><figcaption>Constants used in our DDNS smart contract</figcaption></figure>\n\n\n\n<p>and the state variables where we are going to store the domain names, payment receipts:</p>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/73fa911fb71e40b1392c533dfd0c22ff.js\"></script><figcaption>State variables for storing our data in the DDNS</figcaption></figure>\n\n\n\n<p><strong>Events</strong></p>\n\n\n\n<p>Events in Solidity give an abstraction on top of EVM’s (Ethereum Virtual Machine) logging functionality. An application (e.g. our UI) can subscribe to an event and listen for this events.</p>\n\n\n\n<p>Events are defined with a number of parameters and their type. When an event is fired, its arguments are stored in the transaction’s log.</p>\n\n\n\n<p>Notice the <strong><em>indexed </em></strong>attribute — in Solidity, you can add up to 3 indexed parameters for an event, which will add them to a special structure called “topic”.</p>\n\n\n\n<blockquote class=\"wp-block-quote\"><p>We will get to this point in part 2 when we create the UI for the dApp.</p></blockquote>\n\n\n\n<p>For now, let us just add an event for every action that we are taking on our smart contract. That would be logging that a certain domain name was registered, also log if a domain was renewed. We will add an event for logging domain edits and transfers of a domain ownership. Lastly, we log the <em>money </em>operations and receipt issuing.</p>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/c8f178e98976d57828add23e21710d1f.js\"></script><figcaption>Defined events for the DDNS project implementations</figcaption></figure>\n\n\n\n<h4>Step 4: Implementing functions</h4>\n\n\n\n<blockquote class=\"wp-block-quote\"><p>And now let’s get to the interesting part&nbsp;…</p></blockquote>\n\n\n\n<p>First, we have to implement some functions that are going to help us with our logic, since the logic we’ve been following so far is:</p>\n\n\n\n<ul><li>As we know on the internet we could have domain names that are the same and only the TLD could be different (e.g. <code><strong>hack</strong>.bg</code> and <code><strong>hack</strong>.com</code> )</li><li>We need to have a unique <code>id</code> for each domain name, combined with its TLD.</li><li><strong>Solidity is bad with string manipulation</strong></li></ul>\n\n\n\n<blockquote class=\"wp-block-quote\"><p>The key concept regarding the type <code>string</code> is that this is an array of UTF-8 characters, and can be seamlessly converted to <code>bytes</code>. This is the only way of manipulating the string at all. But it is important to note that UTF-8 characters do not exactly match bytes. The conversion in either direction will be accurate, but there is not an immediate relation between each byte index and the corresponding string index.<br>For most things, there may be an advantage in representing the string directly as the type <code>bytes</code> (avoiding conversions)&nbsp;…</p></blockquote>\n\n\n\n<hr class=\"wp-block-separator\"/>\n\n\n\n<p><strong>Solution</strong>: we create a <strong><em>pure</em></strong> function for calculating the unique hash for provided the domain and topLevel called <strong><em>getDomainHash</em></strong>. It will basically calculate the hash (keccak256) of the provided domain name + its TLD.</p>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/0b8d62c698b0e5bf157be3c5dae41c16.js\"></script><figcaption>getDomainHash — calculate the keccak256 hash of domain + TLD for the DDNS</figcaption></figure>\n\n\n\n<p>By using this function we will be able to get the unique identifier for every domain name.</p>\n\n\n\n<p>Following the same logic — we need a unique <code>id</code> or <code>serialNumber</code> for the payment receipts that we issue — function <strong><em>getReceiptKey</em></strong>:</p>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/aeb598abcb0fa6349be9ee7acc5a9e6e.js\"></script><figcaption>Calculate the receipt serial number/key — used as unique id for DDNS purposes</figcaption></figure>\n\n\n\n<p>* Probably you’ve noticed that these two functions we’ve already referred in the modifiers definitions.</p>\n\n\n\n<p>And a price checker for the provided domain name, since we are going to use this functionality very frequently:</p>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/ce0e5b8442cc9034bb468d9500bf69b1.js\"></script><figcaption>Domain name price checker function — DDNS</figcaption></figure>\n\n\n\n<hr class=\"wp-block-separator\"/>\n\n\n\n<blockquote class=\"wp-block-quote\"><p>… the real deal&nbsp;…</p></blockquote>\n\n\n\n<p><strong>Register a domain name on the decentralized DNS</strong></p>\n\n\n\n<p>We continue with the register domain function — which is probably the most complex of all functions due to our requirements.</p>\n\n\n\n<p>A short explanation of the function below — when a user wants to register a domain name, he passes the <strong>domain</strong>, <strong>TLD</strong> and <strong>IP</strong>, and provides a <em>payment</em> for the domain.</p>\n\n\n\n<p>According to our requirements, some conditions should be met and that is why we’ve created some modifiers earlier at the beginning of this tutorial. They are going to help us to reuse the conditions checks when needed.</p>\n\n\n\n<p>The first thing you notice is that the function is <strong><em>payable —</em></strong>this is required if we want to collect payment in this function, and then we are using</p>\n\n\n\n<ul><li><em>isDomainNameLengthAllowed — </em>checks whether the provided domain’s name length is allowed.</li><li><em>isTopLevelLengthAllowed — </em>checks whether the provided TLD length is allowed.</li><li><em>isAvailable</em> — checks if the domain name is available to be registered (e.g. is it not bought already or if it is expired).</li><li><em>collectDomainNamePayment</em> — checks what is the required amount of ETH to be sent to buy this domain name, according to the conditions for the length of the name. And collects the payment if the user has provided the needed value.</li></ul>\n\n\n\n<p>modifiers.</p>\n\n\n\n<p>If some of the conditions in the modifiers are not met, the contract will stop executing and fire an error message, provided in the <strong><em>require() </em></strong>methods in our modifiers.</p>\n\n\n\n<p>So if everything is OK, we are continuing with the execution of the function (line 19–67):</p>\n\n\n\n<ul><li>What is the logic here?</li></ul>\n\n\n\n<p>We calculate the domain hash, create a domain object, that we store in the storage, then we issue and store a payment receipt and fire two events receipt issuing and domain registration respectively.</p>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/038d4aa4ddad25cc0917228168f50b72.js\"></script><figcaption>Register domain function — DDNS (decentralized domain name system)</figcaption></figure>\n\n\n\n<p><strong>Renew domain name</strong></p>\n\n\n\n<p>This function is similar to the register domain name function — it does the same thing basically, with the only difference of updating the <em>expires </em>property of the requested domain name with 1 year (365 days).</p>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/69d7b9f1ca8674457db380723710aa71.js\"></script><figcaption>Renew Domain Name — DDNS</figcaption></figure>\n\n\n\n<p><strong>Edit domain name</strong></p>\n\n\n\n<p>For the edit domain name, according to the requirements, we should have the ability to update the IP address that the domain is pointing to and that should be a free operation (excluding gas costs).</p>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/9ff2f66540210c858854dd4e84e8ec5d.js\"></script><figcaption>Edit domain name function — DDNS</figcaption></figure>\n\n\n\n<p><strong>Transfer domain</strong></p>\n\n\n\n<p>Transferring the domain name ownership is a trivial task as you’ve probably guessed. There are only a few things that are worth mentioning here:</p>\n\n\n\n<ul><li>first, we check with the <strong><em>isDomainOwner</em></strong> modifier if the transaction initiator (msg.sender) is the owner of the domain</li><li>second, important thing we do is to check whether the new owner’s address is not set to 0x0 address — to prevent domain ownership loss</li><li>the rest is easy — get the domain unique id &gt; update the ownership property with new owner’s address &gt; log the change.</li></ul>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/974b7f5bf5bb37e6458b507ce73840d3.js\"></script><figcaption>Transfer domain name ownership — DDNS</figcaption></figure>\n\n\n\n<p><strong>Getters</strong></p>\n\n\n\n<p>We need to have few getters for accessing the data stored on the blockchain and also for the UI later.</p>\n\n\n\n<p>We will implement functions for getting the current IP of a domain is pointed to — <strong><em>getIp</em></strong>, a function to get the list or receipt <g class=\"gr_ gr_3 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del\" id=\"3\" data-gr-id=\"3\">ids</g> for certain account &#8211;<strong><em>getReceiptList</em></strong>, and a single receipt details getter — <strong><em><g class=\"gr_ gr_5 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del multiReplace\" id=\"5\" data-gr-id=\"5\">getReceipt</g>.</em></strong></p>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/c8dfeaba171d832401c4464d58014ae0.js\"></script><figcaption>Get IP of the provided domain — DDNS</figcaption></figure>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/94b09d8d718dd1cbf450e238a11d1754.js\"></script><figcaption>Get receipt list function — DDNS</figcaption></figure>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/d543b1cb9a724489edca06cdc9a7ce4b.js\"></script><figcaption>Get single receipt details function — DDNS</figcaption></figure>\n\n\n\n<p><strong>Withdraw</strong></p>\n\n\n\n<p>Finally, we want to have a function which is allowing the owner of the decentralized domain name system to be able to withdraw the ETH (funds) collected from domain registration/renewal payments.</p>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/bed65a6e4f29cf050d004888f85b86be.js\"></script><figcaption>Withdraw function — DDNS</figcaption></figure>\n\n\n\n<h4>Finally — here is our smart contract:</h4>\n\n\n\n<p>And here’s the whole smart contract for the DDNS:</p>\n\n\n\n<figure><script src=\"https://gist.github.com/mradkov/e4d9407e2ccfacb8a0b4f8f821ddf55d.js\"></script><figcaption>Decentralized Domain Name System &#8211; Smart Contract</figcaption></figure>\n\n\n\n<hr class=\"wp-block-separator\"/>\n\n\n\n<p>If you are interested in seeing the whole project in action — you can check the whole working project — <a href=\"https://github.com/mradkov/decentralized-dns\" rel=\"noreferrer noopener\" target=\"_blank\">decentralized DNS</a> in Github.</p>\n\n\n\n<hr class=\"wp-block-separator\"/>\n\n\n\n<blockquote class=\"wp-block-quote\"><p>Stay tuned! Part two and three where we will be focusing on unit tests and UI implementation of the decentralized domain name system (DDNS) are coming soon&nbsp;…</p></blockquote>\n\n\n\n<hr class=\"wp-block-separator\"/>\n\n\n\n<h3>Continue&nbsp;…</h3>\n\n\n\n<ul><li>Part two: Unit testing and deploying</li><li>Part three: Building user interface (UI) for our dApp</li></ul>\n\n\n\n<hr class=\"wp-block-separator\"/>\n\n\n\n<h3>Useful links</h3>\n\n\n\n<p>If you want to be informed for our next events and meet-ups — join us:</p>\n\n\n\n<p><strong>Blockchain Developers Meet-up Group</strong>:<a href=\"https://meetup.com/Blockchain-Developers-Meetup-Bulgaria\"><strong>Blockchain Developers Meet-up (Bulgaria)</strong><br><em>In this group, we will share knowledge about blockchain and smart contract development. We will talk about Ethereum…</em>meetup.com</a></p>\n\n\n\n<p><strong>Blockchain Developers Facebook Group</strong>:<a href=\"https://www.facebook.com/groups/BlockchainDevelopersMeetup\"><strong>Log into Facebook | Facebook</strong><br><em>Log into Facebook to start sharing and connecting with your friends, family, and people you know.</em>www.facebook.com</a></p>\n\n\n\n<p><strong>Follow us on social media:</strong></p>\n\n\n\n<ul><li><a href=\"https://twitter.com/hack_bg\" rel=\"noreferrer noopener\" target=\"_blank\">Twitter</a></li><li><a href=\"https://facebook.com/hackbg\" rel=\"noreferrer noopener\" target=\"_blank\">Facebook</a></li><li><a href=\"https://www.linkedin.com/company/hackbg-blockchain-web-software-solutions/\" rel=\"noreferrer noopener\" target=\"_blank\">LinkedIn</a></li></ul>\n","excerpt":"<p>Intro Nowadays it is quite popular to build a decentralized application (dApp). If you are familiar with the blockchain smart contracts development and you’ve already developed something cool, probably there is no need for me to tell you that in this field the demand for good developers is quite high. But for you to be [&hellip;]</p>\n","categories":[{"id":"4","title":"Tutorials","path":"/category/tutorials/"}],"author":{"name":"Milen Radkov","path":"/author/milen/"}}}]}}},"context":{}}